<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title data-i18n="BVBS Korb Generator mit Label-Druck">BVBS Korb Generator mit Label-Druck</title>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bwip-js/3.2.0/bwip-js.min.js"></script>
        <link rel="stylesheet" href="styles.css">
        <script src="i18n.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
        <script src="storage-sync.js" defer></script>
        <script type="importmap">
            {
              "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.164.1/build/three.module.min.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.164.1/examples/jsm/"
              }
            }
        </script>
        <script src="generator.js" defer></script>
        <script src="bf2d-configurator.js" defer></script>
        <script type="module" src="bf2d-viewer3d.js" defer></script>
        <script type="module" src="bfma-viewer3d.js" defer></script>
        <script type="module" src="bf3d-viewer3d.js" defer></script>
        <script src="bfma-configurator.js" defer></script>
        <script src="bf3d-configurator.js" defer></script>
        <script src="service-bus-history.js" defer></script>
        <script src="database-viewer.js" defer></script>
        <script src="production.js" defer></script>
        <script src="bvbs-list.js" defer></script>
        <script type="module" src="viewer3d.js" defer></script>
    </head>
    <body class="is-generator-view">
        <div class="app-main">
            <div class="app-header-wrapper">
                <header class="app-header" role="banner">
                    <nav class="app-nav" aria-label="Hauptnavigation">
                        <button id="showGeneratorBtn" class="sidebar-link" data-view-target="generatorView" data-i18n-title="Generator" title="Generator">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M11 21h-1l1-7H5.6L13 3h1l-1 7h6.5L11 21z" />
                            </svg>
                            <span class="sidebar-text" data-i18n="Generator">Generator</span>
                        </button>
                        <button id="showBvbsListBtn" class="sidebar-link" data-view-target="bvbsListView" data-i18n-title="BVBS-Liste" title="BVBS-Liste">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zm0-12v2h14V7H7z"/>
                            </svg>
                            <span class="sidebar-text" data-i18n="BVBS-Liste">BVBS-Liste</span>
                        </button>
                        <button id="showServiceBusHistoryBtn" class="sidebar-link" data-view-target="serviceBusHistoryView" data-i18n-title="ServiceBusHistory.Nav" title="Service-Bus-Archiv">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M4 6l8 3 8-3V4l-8 3-8-3v2zm0 4l8 3 8-3v-2l-8 3-8-3v2zm0 4l8 3 8-3v-2l-8 3-8-3v2z" />
                            </svg>
                            <span class="sidebar-text" data-i18n="ServiceBusHistory.Nav">Service-Bus-Archiv</span>
                        </button>
                        <button id="showDatabaseViewerBtn" class="sidebar-link" data-view-target="databaseViewerView" data-i18n-title="DatabaseViewer.Nav" title="Datenbank">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M12 3c-4.97 0-9 1.79-9 4v10c0 2.21 4.03 4 9 4s9-1.79 9-4V7c0-2.21-4.03-4-9-4zm0 2c3.86 0 7 1.12 7 2s-3.14 2-7 2-7-1.12-7-2 3.14-2 7-2zm0 14c-3.86 0-7-1.12-7-2v-1.5c1.57 1.1 4.27 1.5 7 1.5s5.43-.4 7-1.5V17c0 .88-3.14 2-7 2zm0-4c-3.86 0-7-1.12-7-2v-1.5c1.57 1.1 4.27 1.5 7 1.5s5.43-.4 7-1.5V13c0 .88-3.14 2-7 2z" />
                            </svg>
                            <span class="sidebar-text" data-i18n="DatabaseViewer.Nav">Datenbank</span>
                        </button>
                        <div class="sidebar-submenu" data-submenu data-submenu-views="bf2dView,bf3dView,bfmaView">
                            <button type="button" class="sidebar-link sidebar-submenu-toggle" data-submenu-toggle aria-expanded="false" data-i18n-title="Biegeformen" title="Biegeformen">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M4 5h8l4 4h4v2h-4l-4-4H4v10H2V5c0-1.1.9-2 2-2h10l4 4h4v2h-4l-4-4H4" />
                                </svg>
                                <span class="sidebar-text" data-i18n="Biegeformen">Biegeformen</span>
                                <svg class="sidebar-submenu-chevron" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                            <div class="sidebar-submenu-list" data-submenu-list aria-hidden="true">
                                <button id="showBf2dBtn" class="sidebar-link sidebar-submenu-link" data-view-target="bf2dView" data-i18n-title="Biegeformen 2D" title="Biegeformen 2D">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M4 5h8l4 4h4v2h-4l-4-4H4v10H2V5c0-1.1.9-2 2-2h10l4 4h4v2h-4l-4-4H4" />
                                    </svg>
                                    <span class="sidebar-text" data-i18n="Biegeformen 2D">Biegeformen 2D</span>
                                </button>
                                <button id="showBf3dBtn" class="sidebar-link sidebar-submenu-link" data-view-target="bf3dView" data-i18n-title="Biegeformen 3D" title="Biegeformen 3D">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M12,7L17,2H7L12,7M12,7L17,12L12,22L7,12L12,7M12,7L2,12L7,17H17L22,12L12,7Z" />
                                    </svg>
                                    <span class="sidebar-text" data-i18n="Biegeformen 3D">Biegeformen 3D</span>
                                </button>
                                <button id="showBfmaBtn" class="sidebar-link sidebar-submenu-link" data-view-target="bfmaView" data-i18n-title="Matten" title="Matten">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M2 2h20v20H2V2zm2 2v16h16V4H4zm2 2h5v5H6V6zm7 0h5v5h-5V6zm-7 7h5v5H6v-5zm7 0h5v5h-5v-5z"/>
                                    </svg>
                                    <span class="sidebar-text" data-i18n="Matten">Matten</span>
                                </button>
                            </div>
                        </div>
                        <button id="showSavedShapesBtn" class="sidebar-link" data-view-target="savedShapesView" data-i18n-title="Gespeicherte Formen" title="Gespeicherte Formen">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M4 4h6v6H4V4zm10 0h6v6h-6V4zM4 14h6v6H4v-6zm10 0h6v6h-6v-6z" />
                            </svg>
                            <span class="sidebar-text" data-i18n="Gespeicherte Formen">Gespeicherte Formen</span>
                        </button>
                        <button id="showProductionBtn" class="sidebar-link" data-view-target="productionView" data-i18n-title="Produktion" title="Produktion">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M3 3h18v2H3V3zm0 7h18v2H3v-2zm0 7h18v2H3v-2z" />
                            </svg>
                            <span class="sidebar-text" data-i18n="Produktion">Produktion</span>
                        </button>
                        <button id="showResourcesBtn" class="sidebar-link" data-view-target="resourcesView" data-i18n-title="Ressourcen" title="Ressourcen">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M12 3c-4.97 0-9 1.79-9 4v10c0 2.21 4.03 4 9 4s9-1.79 9-4V7c0-2.21-4.03-4-9-4zm0 2c3.86 0 7 1.12 7 2s-3.14 2-7 2-7-1.12-7-2 3.14-2 7-2zm0 14c-3.86 0-7-1.12-7-2v-1.5c1.57 1.1 4.27 1.5 7 1.5s5.43-.4 7-1.5V17c0 .88-3.14 2-7 2zm0-4c-3.86 0-7-1.12-7-2v-1.5c1.57 1.1 4.27 1.5 7 1.5s5.43-.4 7-1.5V13c0 .88-3.14 2-7 2z" />
                            </svg>
                            <span class="sidebar-text" data-i18n="Ressourcen">Ressourcen</span>
                        </button>
                        <button id="showSettingsBtn" class="sidebar-link sidebar-link--settings" data-view-target="settingsView" data-i18n-title="Einstellungen" title="Einstellungen">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path d="M12 8a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm9 4c0-.7-.08-1.38-.23-2.03l2.02-1.57-1.9-3.3-2.4.74a8.03 8.03 0 0 0-3.5-2.02L14.5 1h-5l-.49 2.82a8.03 8.03 0 0 0-3.5 2.02l-2.4-.74-1.9 3.3 2.02 1.57A8.27 8.27 0 0 0 3 12c0 .7.08 1.38.23 2.03l-2.02 1.57 1.9 3.3 2.4-.74a8.03 8.03 0 0 0 3.5 2.02l.49 2.82h5l.49-2.82a8.03 8.03 0 0 0 3.5-2.02l2.4.74 1.9-3.3-2.02-1.57c.15-.65.23-1.33.23-2.03z" />
                            </svg>
                            <span class="sidebar-text" data-i18n="Einstellungen">Einstellungen</span>
                        </button>
                    </nav>
                </header>
            </div>
            <main class="app-content">
                <div id="generatorView" class="app-container">
                    <div class="main-grid">
                        <div class="input-column card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="Eingabedaten">Eingabedaten</h2>
                            </div>
                            <div class="generator-summary" role="status" aria-live="polite">
                                <div class="summary-item">
                                    <span class="summary-label" data-i18n="Aktuelle Gesamtlänge">Aktuelle Gesamtlänge</span>
                                    <span class="summary-value" id="summaryTotalLength">0 mm</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label" data-i18n="Zonenzähler">Zonenzähler</span>
                                    <span class="summary-value" id="summaryZoneCount">0</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label" data-i18n="Summe Bügel">Summe Bügel</span>
                                    <span class="summary-value" id="summaryStirrupCount">0</span>
                                </div>
                                <div class="summary-status summary-status--warning" id="summaryStatus" data-i18n="Füge Zonen hinzu, um zu starten.">Füge Zonen hinzu, um zu starten.</div>
                            </div>
                            <div class="input-scroll-container">
                                <h3 class="section-title collapsible-header" data-i18n="Allgemein">Allgemein</h3>
                                <div class="collapsible-content section-content-bg">
                                    <div class="form-group">
                                        <label for="projekt" data-i18n="Projekt (Hj):">Projekt (Hj):</label>
                                        <input type="text" id="projekt" value="TestProjekt" oninput="triggerPreviewUpdateDebounced()">
                                    </div>
                                    <div class="form-group">
                                        <label for="KommNr" data-i18n="KommNr (r):">KommNr (r):</label>
                                        <input type="text" id="KommNr" value="A123" oninput="triggerPreviewUpdateDebounced()">
                                    </div>
                                    <div class="form-group">
                                        <label for="auftrag" data-i18n="Auftrag (i):">Auftrag (i):</label>
                                        <input type="text" id="auftrag" value="Auftrag123" oninput="triggerPreviewUpdateDebounced()">
                                    </div>
                                    <div class="form-group">
                                        <label for="posnr" data-i18n="Pos.-Nr. (p):">Pos.-Nr. (p):</label>
                                        <input type="text" id="posnr" value="1" oninput="triggerPreviewUpdateDebounced()">
                                    </div>
                                    <div class="form-group">
                                        <label for="gesamtlange" data-i18n="Gesamtlänge (l):">Gesamtlänge (l):</label>
                                        <input type="number" id="gesamtlange" value="2000" oninput="triggerPreviewUpdateDebounced(); validateNumberInput(this, 1, 'int', 'Gesamtlänge in mm (min. 1)');">
                                        <span class="input-feedback"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="anzahl" data-i18n="Anzahl Körbe (n):">Anzahl Körbe (n):</label>
                                        <input type="number" id="anzahl" value="1" oninput="triggerPreviewUpdateDebounced(); validateNumberInput(this, 1, 'int', 'Anzahl Körbe (min. 1)');">
                                        <span class="input-feedback"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="langdrahtDurchmesser" data-i18n="Längsdraht-Ø (d):">Längsdraht-Ø (d):</label>
                                        <input type="number" id="langdrahtDurchmesser" value="6" oninput="triggerPreviewUpdateDebounced(); validateNumberInput(this, 1, 'int', 'Längsdraht-Ø in mm (min. 1)');">
                                        <span class="input-feedback"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="stahlgute" data-i18n="Stahlsorte (g):">Stahlsorte (g):</label>
                                        <select id="stahlgute" data-masterdata-source="steelGrades" data-masterdata-placeholder-key="Stahlsorte auswählen…" data-masterdata-default="B500B" oninput="triggerPreviewUpdateDebounced()"></select>
                                    </div>
                                </div>
                                <h3 class="section-title collapsible-header" data-i18n="Optionale (PREFORM 4.0) Daten">Optionale (PREFORM 4.0) Daten</h3>
                                <div class="collapsible-content section-content-bg">
                                    <div class="form-group">
                                        <label for="buegelname1" data-i18n="Bügelname (s) - Zone 1">Bügelname (s) - Zone 1</label>
                                        <div class="input-with-dropdown">
                                            <input type="text" id="buegelname1" value="Forma1" maxlength="30" oninput="triggerPreviewUpdateDebounced()">
                                            <button type="button" class="saved-form-button" id="buegelname1PickerButton" data-target-input="buegelname1" data-zone-label="Zone 1" aria-haspopup="dialog">
                                                <span class="saved-form-button-icon" aria-hidden="true">
                                                    <svg viewBox="0 0 24 24" focusable="false">
                                                        <path d="M4 5h16v2H4V5zm3 6h10v2H7v-2zm-3 6h16v2H4v-2z" />
                                                    </svg>
                                                </span>
                                                <span class="saved-form-button-text" data-default-text="Gespeicherte Biegeform wählen" data-i18n="Gespeicherte Biegeform wählen">Gespeicherte Biegeform wählen</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="buegelname2" data-i18n="Bügelname (s) - Zone 2">Bügelname (s) - Zone 2</label>
                                        <div class="input-with-dropdown">
                                            <input type="text" id="buegelname2" value="" maxlength="30" oninput="triggerPreviewUpdateDebounced()">
                                            <button type="button" class="saved-form-button" id="buegelname2PickerButton" data-target-input="buegelname2" data-zone-label="Zone 2" aria-haspopup="dialog">
                                                <span class="saved-form-button-icon" aria-hidden="true">
                                                    <svg viewBox="0 0 24 24" focusable="false">
                                                        <path d="M4 5h16v2H4V5zm3 6h10v2H7v-2zm-3 6h16v2H4v-2z" />
                                                    </svg>
                                                </span>
                                                <span class="saved-form-button-text" data-default-text="Gespeicherte Biegeform wählen" data-i18n="Gespeicherte Biegeform wählen">Gespeicherte Biegeform wählen</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="rezeptname" data-i18n="Rezeptname (r):">Rezeptname (r):</label>
                                        <input type="text" id="rezeptname" value="RezeptABC" maxlength="30" oninput="triggerPreviewUpdateDebounced()">
                                    </div>
                                </div>
                                <h3 class="section-title collapsible-header" data-i18n="PtGABBIE-Daten">PtGABBIE-Daten</h3>
                                <div class="collapsible-content section-content-bg">
                                    <h4 style="font-size: .95rem; font-weight: 600; margin-bottom: .5rem; color: var(--heading-color);" data-i18n="Lagen-Templates">Lagen-Templates</h4>
                                    <div class="form-group">
                                        <label for="templateSelect" data-i18n="Template laden:">Template laden:</label>
                                        <select id="templateSelect" onchange="applyTemplate(this.value)">
                                            <option value="" data-i18n="Template auswählen…">Template auswählen…</option>
                                        </select>
                                    </div>
                                    <div class="button-group" style="justify-content: flex-end; margin-bottom: 1rem;">
                                        <button type="button" class="btn-secondary" id="openTemplateManagerButton">
                                            <svg viewBox="0 0 24 24" style="width: 1.1em; height: 1.1em; margin-right: .5em;">
                                                <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                                            </svg>
                                            <span data-i18n="Templates verwalten">Templates verwalten</span>
                                        </button>
                                    </div>
                                    <div class="form-group">
                                        <label for="templateName" data-i18n="Korb Template Name:">Korb Template Name:</label>
                                        <input type="text" id="templateName" placeholder="Neuer Template-Name...">
                                    </div>
                                    <div class="button-group" style="justify-content: flex-end;">
                                        <button type="button" class="btn-secondary" id="saveCurrentTemplateButton">
                                            <svg viewBox="0 0 24 24">
                                                <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"></path>
                                            </svg>
                                            <span data-i18n="Template speichern">Template speichern</span>
                                        </button>
                                        <button type="button" class="btn-secondary" id="downloadTemplatesButton">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                                <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/>
                                            </svg>
                                            <span data-i18n="Templates herunterladen">Templates herunterladen</span>
                                        </button>
                                    </div>
                                    <span id="templateFeedback" class="info-text" style="text-align: right; margin-top: -.5rem;"></span>
                                    <hr style="margin: 1rem 0;">
                                    <div class="form-group">
                                        <label for="anfangsueberstand" data-i18n="Anfangsüberst. (i):">Anfangsüberst. (i):</label>
                                        <input type="number" id="anfangsueberstand" value="0" oninput="triggerPreviewUpdateDebounced(); validateNumberInput(this, 0, 'int', 'Anfangsüberstand in mm (min. 0)');">
                                        <span class="input-feedback"></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="endueberstand" data-i18n="Endüberstand (f):">Endüberstand (f):</label>
                                        <input type="number" id="endueberstand" value="0" oninput="triggerPreviewUpdateDebounced(); validateNumberInput(this, 0, 'int', 'Endüberstand in mm (min. 0)');">
                                        <span class="input-feedback"></span>
                                    </div>
                                    <h4 style="font-size: .95rem; font-weight: 600; margin-top: 1rem; margin-bottom: .5rem; color: var(--heading-color);" data-i18n="Bügelzonen">Bügelzonen</h4>
                                    <div class="form-group">
                                        <label for="maxZonesInput" data-i18n="Max. Zonen">Max. Zonen</label>
                                        <input type="number" id="maxZonesInput" value="20" min="1" oninput="updateMaxZones(this.value)">
                                    </div>
                                    <div class="form-group">
                                        <label for="zonesPerLabelInput" data-i18n="Zonenanzahl Zone 1">Zonenanzahl Zone 1</label>
                                        <input type="number" id="zonesPerLabelInput" value="16" min="1" oninput="updateZonesPerLabel(this.value)">
                                    </div>
                                    <div class="zone-table-wrapper">
                                        <table id="zonesTable" class="full-width-table">
                                            <thead>
                                                <tr>
                                                    <th style="width: 30px; padding: 0;"></th>
                                                    <th data-i18n="Bügel Ø">Bügel Ø</th>
                                                    <th data-i18n="Anzahl">Anzahl</th>
                                                    <th data-i18n="Abstand mm">Abstand mm</th>
                                                    <th style="width: 25px;"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="button-group" style="margin-top: .5rem; justify-content: flex-end;">
                                        <button type="button" class="btn-secondary" id="addZoneButton" style="width: auto;">
                                            <svg viewBox="0 0 24 24" style="width: 1.1em; height: 1.1em; margin-right: .5em;">
                                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                                            </svg>
                                            <span data-i18n="Neue Zone hinzufügen">Neue Zone hinzufügen</span>
                                        </button>
                                    </div>
                                    <span class="info-text" style="margin-top: .2rem; display: block;" data-i18n="Jede Zone: Durchmesser, Anzahl, Pitch.">Jede Zone: Durchmesser, Anzahl, Pitch.</span>
                                </div>
                            </div>
                            <div style="margin-top: auto; padding-top: 1rem; background-color: var(--card-bg-color); border-top: 1px solid var(--border-color); z-index: 10; position: sticky; bottom: 0; margin-left: -1rem; margin-right: -1rem; padding-left: 1rem; padding-right: 1rem;">
                                <button type="button" id="generateButton" style="width: 100%; padding: .75rem 1rem; font-size: 1rem;">
                                    <svg viewBox="0 0 24 24" style="width: 1.1em; height: 1.1em; margin-right: .5em;">
                                        <path d="M20 8H4V6h16v2zm-2-6H6v2h12V2zm4 10v8c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2v-8c0-1.1.9-2 2-2h16c1.1 0 2 .9 2 2zm-6 4h-4v4h4v-4z"></path>
                                    </svg>
                                    <span data-i18n="BVBS Code & Barcode generieren">BVBS Code & Barcode generieren</span>
                                </button>
                                <div id="generateError" class="info-text" style="margin-top: .5rem; min-height: 1.2em;"></div>
                            </div>
                        </div>
                        <div class="preview-column">
                            <div class="card preview-card layout-full">
                        <div class="card-header preview-header">
                            <div class="preview-title">
                                <h2 class="card-title" data-i18n="Visuelle Vorschau Korb">Visuelle Vorschau Korb</h2>
                                <p class="card-subtitle" data-i18n="Interaktive Vorschau und Kontrolle">Interaktive Vorschau und Kontrolle</p>
                            </div>
                            <div class="preview-toolbar">
                                <div class="toolbar-group">
                                    <span class="toolbar-label" data-i18n="Ansicht">Ansicht</span>
                                    <div class="view-toggle-buttons">
                                        <button type="button" id="view2dBtn" class="btn-toggle active" data-i18n="2D-Ansicht">2D-Ansicht</button>
                                        <button type="button" id="view3dBtn" class="btn-toggle" data-i18n="3D-Ansicht">3D-Ansicht</button>
                                    </div>
                                </div>
                                <div class="toolbar-group">
                                    <span class="toolbar-label" data-i18n="Darstellung">Darstellung</span>
                                    <div class="toolbar-row toggle-inline">
                                        <input type="checkbox" id="overhangToggle" onchange="toggleOverhangVisibility(this.checked)">
                                        <label for="overhangToggle" data-i18n="Überstände anzeigen">Überstände anzeigen</label>
                                    </div>
                                    <div class="toolbar-row">
                                        <label for="dimensioningToggle" data-i18n="Bemaßung Zonenlänge">Bemaßung Zonenlänge</label>
                                        <select id="dimensioningToggle" onchange="toggleDimensioningMode(this.value)">
                                            <option value="arrangementLength" selected data-i18n="(n-1) x Pitch">(n-1) x Pitch</option>
                                            <option value="totalZoneSpace" data-i18n="n x Pitch">n x Pitch</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="toolbar-group toolbar-group--action">
                                    <span class="toolbar-label" data-i18n="Schnellstart">Schnellstart</span>
                                    <button type="button" class="btn-secondary preview-action-btn" id="loadSampleBasketBtn" data-i18n-title="Beispielkorb laden">
                                        <svg viewBox="0 0 24 24" aria-hidden="true">
                                            <path d="M12 2l9 5v6c0 3.87-3.13 7-7 7H10c-3.87 0-7-3.13-7-7V7l9-5zm0 2.18L5 7.09v5.91c0 3.31 2.69 6 6 6h4c3.31 0 6-2.69 6-6V7.09l-7-2.91zm-1 4.32h2v3h3v2h-3v3h-2v-3H8v-2h3v-3z" />
                                        </svg>
                                        <span data-i18n="Beispielkorb laden">Beispielkorb laden</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="visualPreviewContainer">
                            <div id="cagePreviewSvgContainer">
                                <svg id="cagePreviewSvg" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet"></svg>
                            </div>
                            <div id="viewer3dContainer" style="display: none;"></div>
                            <div id="previewError" class="info-text"></div>
                        </div>
                        <div class="download-canvas-btn-container">
                            <button type="button" class="btn-secondary" id="downloadSvgButton">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M0 0h24v24H0z" fill="none"/>
                                    <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/>
                                </svg>
                                <span data-i18n="Vorschau als SVG">Vorschau als SVG</span>
                            </button>
                        </div>
                    </div>
                    <div class="card zone-summary-table-container layout-full">
                        <div class="card-header">
                            <h2 class="card-title" data-i18n="Zonenübersicht">Zonenübersicht</h2>
                        </div>
                        <div class="zone-summary-table-wrapper">
                            <table id="zoneSummaryTable">
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="card generated-code-container layout-full">
                        <div class="card-header">
                            <h2 class="card-title" data-i18n="Generierter BVBS Code">Generierter BVBS Code</h2>
                        </div>
                        <div class="output-area">
                            <div class="bvbs-output-field">
                                <textarea id="outputBvbsCode1" readonly></textarea>
                                <button type="button" class="btn-success copy-bvbs-btn" data-target="outputBvbsCode1" title="Kopieren">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                                    </svg>
                                    <span data-i18n="Kopieren">Kopieren</span>
                                </button>
                                <button type="button" class="btn-secondary open-qr-btn" data-target="outputBvbsCode1" data-label="1" data-i18n-title="QR-Code anzeigen">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M3 3h8v8H3V3zm2 2v4h4V5H5zm8-2h8v8h-8V3zm2 2v4h4V5h-4zM3 13h8v8H3v-8zm2 2v4h4v-4H5zm10 0h2v2h-2v-2zm4 0h2v2h-2v-2zm-4 4h2v2h-2v-2zm4 0h2v4h-4v-2h2v-2z"/>
                                    </svg>
                                    <span data-i18n="QR-Code anzeigen">QR-Code anzeigen</span>
                                </button>
                            </div>
                            <div class="bvbs-output-field" id="bvbsOutputField2" style="display:none;">
                                <textarea id="outputBvbsCode2" readonly></textarea>
                                <button type="button" class="btn-success copy-bvbs-btn" data-target="outputBvbsCode2" title="Kopieren">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                                    </svg>
                                    <span data-i18n="Kopieren">Kopieren</span>
                                </button>
                                <button type="button" class="btn-secondary open-qr-btn" data-target="outputBvbsCode2" data-label="2" data-i18n-title="QR-Code anzeigen">
                                    <svg viewBox="0 0 24 24" aria-hidden="true">
                                        <path d="M3 3h8v8H3V3zm2 2v4h4V5H5zm8-2h8v8h-8V3zm2 2v4h4V5h-4zM3 13h8v8H3v-8zm2 2v4h4v-4H5zm10 0h2v2h-2v-2zm4 0h2v2h-2v-2zm-4 4h2v2h-2v-2zm4 0h2v4h-4v-2h2v-2z"/>
                                    </svg>
                                    <span data-i18n="QR-Code anzeigen">QR-Code anzeigen</span>
                                </button>
                            </div>
                        </div>
                        <span id="copyFeedback" class="copy-feedback-text" style="text-align: right; display: block;"></span>
                    </div>
                    <div id="barcodeSvgContainer" class="hidden"></div>
                    <div id="barcodeError" class="info-text" style="display:none;"></div>
                    <div class="card label-preview-card layout-full">
                        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 class="card-title" data-i18n="Druck-Label Vorschau">Druck-Label Vorschau</h2>
                            <button id="printLabelButton" style="margin-left: auto;">
                                <svg viewBox="0 0 24 24" style="width:1.2em;height:1.2em;margin-right:.5em;">
                                    <path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7
                                        c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"/>
                                </svg>
                                <span data-i18n="Label drucken">Label drucken</span>
                            </button>
                            <button id="showZplButton" class="btn-secondary" style="margin-left:.5rem;">
                                <svg viewBox="0 0 24 24" style="width:1.2em;height:1.2em;margin-right:.5em;">
                                    <path d="M3 4v16h18V4H3zm16 14H5V6h14v12zM8 8h8v2H8V8zm0 4h8v2H8v-2z"/>
                                </svg>
                                <span data-i18n="ZPL anzeigen">ZPL anzeigen</span>
                            </button>
                            <button id="editLabelLayoutButton" class="btn-secondary" style="margin-left:.5rem;">
                                <svg viewBox="0 0 24 24" style="width:1.2em;height:1.2em;margin-right:.5em;">
                                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zm2.92 2.92h-.67v-.67L14.06 11l.67.67L5.92 20.17zM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/>
                                </svg>
                                <span data-i18n="Layout bearbeiten">Layout bearbeiten</span>
                            </button>
                        </div>
                        <div id="labelPreviewContainer"
                            style="display: flex; justify-content: center; gap: 10mm; padding: 1rem;
                            background-color: var(--light-bg-color);
                            border-radius: var(--border-radius);">
                            <div class="label-wrapper">
                                <div id="printableLabel"
                                    style="
                                    width: 100mm;
                                    border: 1px dashed #999;
                                    background: white;
                                    padding: 4mm;
                                    box-sizing: border-box;
                                    ">
                                    <div style="
                                        display: flex;
                                        justify-content: space-between;
                                        align-items: flex-start;
                                        margin-bottom: 4mm;
                                        ">
                                        <h3 style="
                                            margin: 0;
                                            font-size: 16pt;
                                            font-weight: bold;
                                            ">
                                            <span id="descPosnr" data-i18n="Pos‑Nr:">Pos‑Nr:</span> <span id="labelPosnr"></span>
                                        </h3>
                                        <div style="display:flex;flex-direction:column;align-items:flex-end;font-size:14pt;font-weight:bold;color:#000;">
                                            <div id="labelKommNr"></div>
                                            <div id="labelBuegelname"></div>
                                        </div>
                                    </div>
                                    <div class="label-grid" style="
                                        display: grid;
                                        grid-template-columns: auto 1fr;
                                        gap: 1mm 3mm;
                                        font-size: 12pt;
                                        margin-bottom: 4mm;
                                        ">
                                        <div id="descProjekt" data-i18n="Projekt:">Projekt:</div>
                                        <div id="labelProjekt"></div>
                                        <div id="descAuftrag" data-i18n="Auftrag:">Auftrag:</div>
                                        <div id="labelAuftrag"></div>
                                        <div id="descLange" data-i18n="Länge:">Länge:</div>
                                        <div id="labelGesamtlange"></div>
                                    </div>
                                    <div id="labelBarcodeContainer" style="text-align: center; margin-top: 4mm;">
                                        </div>
                                    <div id="labelBarcodeFallback" style="text-align: center; margin-top: 4mm;">
                                        <img id="labelBarcodeImage" src="" alt="Barcode" style="display:none; max-width:100%; height:auto;">
                                        <div id="labelBarcodeText" style="display:none; font-size:8pt; word-break:break-all; font-family:monospace; color:#333;"></div>
                                    </div>
                                </div>
                                <button type="button" class="label-save-btn download-label-btn" data-target="printableLabel" data-i18n-title="Label als PNG speichern" title="Label als PNG speichern">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="label-wrapper">
                                <div id="printableLabel2" style="width: 100mm; border: 1px dashed #999; background: white; padding: 4mm; box-sizing: border-box;">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 4mm;">
                <h3 style="margin: 0; font-size: 16pt; font-weight: bold;"><span id="descPosnr2" data-i18n="Pos‑Nr:">Pos‑Nr:</span> <span id="labelPosnr2"></span></h3>
                <div style="display:flex;flex-direction:column;align-items:flex-end;font-size:14pt;font-weight:bold;color:#000;">
                    <div id="labelKommNr2"></div>
                    <div id="labelBuegelname2"></div>
                </div>
            </div>
            <div class="label-grid" style="display: grid; grid-template-columns: auto 1fr; gap: 1mm 3mm; font-size: 12pt; margin-bottom: 4mm;">
                <div id="descProjekt2" data-i18n="Projekt:">Projekt:</div>
                <div id="labelProjekt2"></div>
                <div id="descAuftrag2" data-i18n="Auftrag:">Auftrag:</div>
                <div id="labelAuftrag2"></div>
                <div id="descLange2" data-i18n="Länge:">Länge:</div>
                <div id="labelGesamtlange2"></div>
            </div>
            <div id="labelBarcodeContainer2" style="text-align: center; margin-top: 4mm;"></div>
            <div id="labelBarcodeFallback2" style="text-align: center; margin-top: 4mm;">
                <img id="labelBarcodeImage2" src="" alt="Barcode" style="display:none; max-width:100%; height:auto;">
                <div id="labelBarcodeText2" style="display:none; font-size:8pt; word-break:break-all; font-family:monospace; color:#333;"></div>
            </div>
        </div>
                                <button type="button" class="label-save-btn download-label-btn" data-target="printableLabel2" data-i18n-title="Label als PNG speichern" title="Label als PNG speichern">
                                    <svg viewBox="0 0 24 24">
                                        <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="button-group" style="justify-content: flex-end; margin-top: 1rem;">
                            <button type="button" id="openSavedOrdersButton" class="btn-secondary" data-i18n="Gespeicherte Aufträge">Gespeicherte Aufträge</button>
                            <button type="button" id="saveOrderButton" class="btn-secondary" data-i18n="Auftrag speichern">Auftrag speichern</button>
                            <button type="button" id="releaseButton" class="btn-primary" data-i18n="Freigeben">Freigeben</button>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
                <div id="bf2dView" class="app-container" style="display:none;">
                    <div class="bf2d-layout">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="BF2D Konfigurator">BF2D Konfigurator</h2>
                            </div>
                            <div class="bf2d-form-grid">
                                <section class="bf2d-form-section">
                                    <h3 class="bf2d-form-section-title" data-i18n="Allgemeine Angaben">Allgemeine Angaben</h3>
                                    <div class="bf2d-form-section-body">
                                        <div class="form-group">
                                            <label for="bf2dProject" data-i18n="Projekt">Projekt</label>
                                            <input type="text" id="bf2dProject" value="Projekt A">
                                        </div>
                                        <div class="form-group">
                                            <label for="bf2dOrder" data-i18n="Auftrag">Auftrag</label>
                                            <input type="text" id="bf2dOrder" value="A-001">
                                        </div>
                                        <div class="form-group">
                                            <label for="bf2dPosition" data-i18n="Pos.-Nr.">Pos.-Nr.</label>
                                            <input type="text" id="bf2dPosition" value="1">
                                        </div>
                                        <div class="form-group">
                                            <label for="bf2dType" data-i18n="Typ">Typ</label>
                                            <input type="text" id="bf2dType" value="BWS">
                                        </div>
                                        <div class="form-group">
                                            <label for="bf2dRemark" data-i18n="Bemerkung">Bemerkung</label>
                                            <input type="text" id="bf2dRemark">
                                        </div>
                                    </div>
                                </section>
                                <section class="bf2d-form-section">
                                    <h3 class="bf2d-form-section-title" data-i18n="Produktionsparameter">Produktionsparameter</h3>
                                    <div class="bf2d-form-section-body">
                                        <div class="form-group">
                                            <label for="bf2dDiameter" data-i18n="Durchmesser (mm)">Durchmesser (mm)</label>
                                            <input type="number" id="bf2dDiameter" value="12" min="1" step="0.1">
                                        </div>
                                        <div class="form-group">
                                            <label for="bf2dRollDiameter" data-i18n="Biegerollendurchmesser (mm)">Biegerollendurchmesser (mm)</label>
                                            <select id="bf2dRollDiameter" data-masterdata-source="rollDiameters" data-masterdata-placeholder-key="Biegerollendurchmesser auswählen…" data-masterdata-default="48"></select>
                                        </div>
                                        <div class="form-group">
                                            <label for="bf2dQuantity" data-i18n="Stückzahl">Stückzahl</label>
                                            <input type="number" id="bf2dQuantity" value="1" min="1" step="1">
                                        </div>
                                        <div class="form-group">
                                            <label for="bf2dSteelGrade" data-i18n="Stahlsorte">Stahlsorte</label>
                                            <select id="bf2dSteelGrade" data-masterdata-source="steelGrades" data-masterdata-placeholder-key="Stahlsorte auswählen…" data-masterdata-default="B500B"></select>
                                        </div>
                                    </div>
                                </section>
                            </div>
                            <div class="bf2d-storage-controls">
                                <div class="form-group">
                                    <label for="bf2dShapeName" data-i18n="Biegeform-Name">Biegeform-Name</label>
                                    <input type="text" id="bf2dShapeName" data-i18n-placeholder="Biegeform-Name eingeben…" placeholder="Biegeform-Name eingeben…">
                                </div>
                                <div class="form-group">
                                    <label for="bf2dSavedForms" data-i18n="Gespeicherte Biegeformen">Gespeicherte Biegeformen</label>
                                    <select id="bf2dSavedForms" disabled>
                                        <option value="" data-i18n="Gespeicherte Biegeform auswählen…">Gespeicherte Biegeform auswählen…</option>
                                    </select>
                                </div>
                                <div class="bf2d-storage-actions button-group">
                                    <button type="button" id="bf2dSaveShapeButton" class="btn-secondary" data-i18n="Speichern">Speichern</button>
                                    <button type="button" id="bf2dLoadShapeButton" class="btn-secondary" data-i18n="Laden" disabled>Laden</button>
                                    <button type="button" id="bf2dDeleteShapeButton" class="btn-danger" data-i18n="Löschen" disabled>Löschen</button>
                                    <button type="button" id="bf2dOpenLibraryButton" class="btn-secondary" data-i18n="Bibliothek">Bibliothek</button>
                                </div>
                            </div>
                            <div class="bf2d-summary-grid">
                                <div class="bf2d-summary-item">
                                    <span class="bf2d-summary-label" data-i18n="Gesamtlänge">Gesamtlänge</span>
                                    <span class="bf2d-summary-value" id="bf2dSummaryTotalLength">0 mm</span>
                                </div>
                                <div class="bf2d-summary-item">
                                    <span class="bf2d-summary-label" data-i18n="Gerade Länge">Gerade Länge</span>
                                    <span class="bf2d-summary-value" id="bf2dSummaryStraightLength">0 mm</span>
                                </div>
                                <div class="bf2d-summary-item">
                                    <span class="bf2d-summary-label" data-i18n="Bogenlänge">Bogenlänge</span>
                                    <span class="bf2d-summary-value" id="bf2dSummaryArcLength">0 mm</span>
                                </div>
                                <div class="bf2d-summary-item">
                                    <span class="bf2d-summary-label" data-i18n="Maß (BxH)">Maß (BxH)</span>
                                    <span class="bf2d-summary-value" id="bf2dSummaryDimensions">0 × 0 mm</span>
                                </div>
                                <div class="bf2d-summary-item">
                                    <span class="bf2d-summary-label" data-i18n="Gewicht pro Stab">Gewicht pro Stab</span>
                                    <span class="bf2d-summary-value" id="bf2dSummaryWeight">0 kg</span>
                                </div>
                                <div class="bf2d-summary-item">
                                    <span class="bf2d-summary-label" data-i18n="Gesamtgewicht">Gesamtgewicht</span>
                                    <span class="bf2d-summary-value" id="bf2dSummaryTotalWeight">0 kg</span>
                                </div>
                            </div>
                            <div id="bf2dStatus" class="info-text" aria-live="polite"></div>
                        </div>
                        <div class="card bf2d-machine-card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="Maschinen-Eignung">Maschinen-Eignung</h2>
                            </div>
                            <div class="bf2d-machine-compatibility">
                                <p id="bf2dMachineCompatibilityStatus" class="info-text" aria-live="polite"></p>
                                <ul id="bf2dMachineCompatibilityList" class="bf2d-machine-list" role="list"></ul>
                            </div>
                        </div>
                        <div id="bf2dOptimizerCard" class="card bf2d-optimizer-card" style="display: none;">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="Optimierungs-Vorschläge">Optimierungs-Vorschläge</h2>
                            </div>
                            <div id="bf2dOptimizerList" class="bf2d-optimizer-list"></div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="Segmenteditor">Segmenteditor</h2>
                                <div class="button-group" style="justify-content: flex-end;">
                                    <button type="button" id="bf2dAddSegmentButton" class="btn-secondary">
                                        <svg viewBox="0 0 24 24" aria-hidden="true">
                                            <path d="M12 5v6H6v2h6v6h2v-6h6v-2h-6V5z" />
                                        </svg>
                                        <span data-i18n="Segment hinzufügen">Segment hinzufügen</span>
                                    </button>
                                </div>
                            </div>
                            <div class="bf2d-segment-table-wrapper">
                                <table class="full-width-table bf2d-segment-table">
                                    <thead>
                                        <tr>
                                            <th data-i18n="Abschnitt">Abschnitt</th>
                                            <th data-i18n="Länge (mm)">Länge (mm)</th>
                                            <th data-i18n="Biegewinkel (°)">Biegewinkel (°)</th>
                                            <th data-i18n="Richtung">Richtung</th>
                                            <th data-i18n="Radius (mm)">Radius (mm)</th>
                                            <th data-i18n="Aktionen">Aktionen</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bf2dSegmentsBody"></tbody>
                                </table>
                            </div>
                            <ul id="bf2dErrorList" class="bf2d-error-list"></ul>
                        </div>
                        <div class="card bf2d-import-card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="ABS-Import">ABS-Import</h2>
                                <div class="button-group" style="justify-content: flex-end;">
                                    <button type="button" id="bf2dOpenImportButton" class="btn-primary">
                                        <svg viewBox="0 0 24 24" aria-hidden="true">
                                            <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4c-2.89 0-5.4 1.64-6.65 4.04C2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/>
                                        </svg>
                                        <span data-i18n="ABS-Datei importieren">ABS-Datei importieren</span>
                                    </button>
                                    <button type="button" id="bf2dClearImportButton" class="btn-secondary" style="display: none;">
                                        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                                        <span data-i18n="Import löschen">Import löschen</span>
                                    </button>
                                    <button type="button" id="bf2dExportSelectionButton" class="btn-secondary" disabled>
                                         <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M5 20h14v-2H5v2zm7-18-5 5h3v6h4V7h3l-5-5z" /></svg>
                                        <span data-i18n="Auswahl exportieren">Auswahl exportieren</span>
                                    </button>
                                </div>
                            </div>
                            <div id="bf2dDropZone" class="bf2d-drop-zone">
                                <div class="bf2d-drop-zone-content">
                                    <div class="bf2d-drop-zone-instructions">
                                        <svg class="bf2d-drop-zone-icon" viewBox="0 0 24 24" aria-hidden="true">
                                            <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/>
                                        </svg>
                                        <p data-i18n="ABS-Datei hierher ziehen oder den Button verwenden.">ABS-Datei hierher ziehen oder<br>den Button oben verwenden.</p>
                                        <span class="bf2d-drop-zone-note" data-i18n="Dateityp: .abs">Dateityp: .abs</span>
                                    </div>
                                    <div id="bf2dImportContent" class="bf2d-import-content" style="display: none;">
                                        <div id="bf2dImportStatus" class="info-text" aria-live="polite"></div>
                                        <div class="bf2d-import-table-wrapper">
                                            <table id="bf2dImportTable" class="full-width-table bf2d-import-table">
                                                <thead>
                                                    <tr>
                                                        <th style="width:32px;"><input type="checkbox" id="bf2dImportSelectAll"></th>
                                                        <th data-i18n="Typ">Typ</th>
                                                        <th data-i18n="Pos.-Nr.">Pos.-Nr.</th>
                                                        <th data-i18n="⌀ (mm)">⌀ (mm)</th>
                                                        <th data-i18n="Länge gesamt">Länge gesamt</th>
                                                        <th data-i18n="Anzahl">Anzahl</th>
                                                        <th data-i18n="Prüfsumme">Prüfsumme</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="bf2dImportTableBody"></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <input type="file" id="bf2dImportFileInput" accept=".abs,text/plain" style="display:none">
                        </div>
                        <div class="card preview-card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="SVG Vorschau">SVG Vorschau</h2>
                            </div>
                            <div class="bf2d-preview-container" data-view-mode="2d">
                                <div class="bf2d-preview-controls">
                                    <div class="bf2d-view-toggle" role="group" aria-label="Ansicht umschalten">
                                        <button type="button" id="bf2dViewToggle2d" class="bf2d-view-toggle-btn is-active" aria-pressed="true" data-i18n="2D">2D</button>
                                        <button type="button" id="bf2dViewToggle3d" class="bf2d-view-toggle-btn" aria-pressed="false" data-i18n="3D">3D</button>
                                    </div>
                                    <div class="bf2d-toggle bf2d-when-2d">
                                        <input type="checkbox" id="bf2dShowLengths" checked>
                                        <label for="bf2dShowLengths" data-i18n="Längen anzeigen">Längen anzeigen</label>
                                    </div>
                                    <div class="bf2d-toggle bf2d-when-2d">
                                        <input type="checkbox" id="bf2dShowRadii" checked>
                                        <label for="bf2dShowRadii" data-i18n="Radien anzeigen">Radien anzeigen</label>
                                    </div>
                                    <div class="bf2d-dimension-toggle-group bf2d-when-3d" role="group" aria-label="Bemaßungen umschalten">
                                        <label class="bf2d-dimension-toggle">
                                            <input type="checkbox" id="bf2d3dToggleDimensions" checked>
                                            <span data-i18n="Maße anzeigen">Maße anzeigen</span>
                                        </label>
                                        <label class="bf2d-dimension-toggle">
                                            <input type="checkbox" id="bf2d3dToggleZoneLengths" checked>
                                            <span data-i18n="Zonenlängen">Zonenlängen</span>
                                        </label>
                                        <label class="bf2d-dimension-toggle">
                                            <input type="checkbox" id="bf2d3dToggleOverhangs" checked>
                                            <span data-i18n="Überstände">Überstände</span>
                                        </label>
                                    </div>
                                    <div class="bf2d-preview-actions bf2d-when-3d">
                                        <button type="button" id="bf2dReset3dButton" class="btn-secondary" data-i18n="Reset View">Reset View</button>
                                        <button type="button" id="bf2dZoom3dButton" class="btn-secondary" data-i18n="Zoom to Fit">Zoom to Fit</button>
                                    </div>
                                </div>
                                <div class="bf2d-preview-stage">
                                    <svg id="bf2dPreviewSvg" role="img" aria-label="BF2D Vorschau"></svg>
                                    <div id="bf2dPreview3d" class="bf2d-preview-3d" aria-hidden="true"></div>
                                </div>
                            </div>
                            <p id="bf2dPreviewNote" class="info-text" aria-live="polite"></p>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="BVBS-ABS Datensatz">BVBS-ABS Datensatz</h2>
                                <div class="button-group" style="justify-content: flex-end;">
                                    <button type="button" id="bf2dCopyButton" class="btn-secondary">
                                        <svg viewBox="0 0 24 24" aria-hidden="true">
                                            <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z" />
                                        </svg>
                                        <span data-i18n="Datensatz kopieren">Datensatz kopieren</span>
                                    </button>
                                    <button type="button" id="bf2dDownloadButton" class="btn-primary">
                                        <svg viewBox="0 0 24 24" aria-hidden="true">
                                            <path d="M5 20h14v-2H5v2zm7-18-5 5h3v6h4V7h3l-5-5z" />
                                        </svg>
                                        <span data-i18n="Datensatz herunterladen">Datensatz herunterladen</span>
                                    </button>
                                </div>
                            </div>
                            <textarea id="bf2dDatasetOutput" readonly spellcheck="false"></textarea>
                            <div id="bf2dDatasetStatus" class="info-text" aria-live="polite"></div>
                        </div>
                    </div>
                </div>
<div id="bf3dView" class="app-container" style="display:none;">
    <div class="bf3d-layout">
        <div class="bf3d-column">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title" data-i18n="BF3D Konfigurator">BF3D Konfigurator</h2>
                </div>
                <div class="bf2d-form-grid">
                    <div class="form-group">
                        <label for="bf3dPosition" data-i18n="Pos.-Nr. (p)">Pos.-Nr. (p)</label>
                        <input type="text" id="bf3dPosition" value="1">
                    </div>
                    <div class="form-group">
                        <label for="bf3dType" data-i18n="Typ">Typ</label>
                        <input type="text" id="bf3dType" value="BWS">
                    </div>
                    <div class="form-group">
                        <label for="bf3dQuantity" data-i18n="Anzahl (n)">Anzahl (n)</label>
                        <input type="number" id="bf3dQuantity" value="1" min="1">
                    </div>
                    <div class="form-group">
                        <label for="bf3dDiameter" data-i18n="Durchmesser (d)">Durchmesser (d)</label>
                        <input type="number" id="bf3dDiameter" value="10" min="1">
                    </div>
                    <div class="form-group">
                        <label for="bf3dSteelGrade" data-i18n="Stahlsorte (g)">Stahlsorte (g)</label>
                        <select id="bf3dSteelGrade" data-masterdata-source="steelGrades" data-masterdata-placeholder-key="Stahlsorte auswählen…" data-masterdata-default="B500B"></select>
                    </div>
                    <div class="form-group">
                        <label for="bf3dBendingRoller" data-i18n="Biegerolle (s)">Biegerolle (s)</label>
                        <select id="bf3dBendingRoller" data-masterdata-source="rollDiameters" data-masterdata-placeholder-key="Biegerollendurchmesser auswählen…" data-masterdata-default="40"></select>
                    </div>
                </div>
                <div class="card-header">
                    <h2 class="card-title" data-i18n="Geometrie">Geometrie</h2>
                </div>
                <div class="bf2d-segment-table-wrapper">
                    <table class="full-width-table" id="bf3dPointTable">
                        <thead>
                            <tr>
                                <th data-i18n="Punkt">Punkt</th>
                                <th data-i18n="X">X</th>
                                <th data-i18n="Y">Y</th>
                                <th data-i18n="Z">Z</th>
                                <th data-i18n="Aktionen">Aktionen</th>
                            </tr>
                        </thead>
                        <tbody id="bf3dPointTableBody"></tbody>
                    </table>
                </div>
                <div class="button-group">
                    <button type="button" id="bf3dAddPoint" class="btn-secondary" data-i18n="Punkt hinzufügen">Punkt hinzufügen</button>
                    <button type="button" id="bf3dRemovePoint" class="btn-danger" data-i18n="Punkt löschen" disabled>Punkt löschen</button>
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="bf3dSnapGrid"> <span data-i18n="Am Raster fangen">Am Raster fangen</span></label>
                    <input type="number" id="bf3dGridSize" value="10" min="1" style="width: 60px;"> mm
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="bf3dForceIntegers"> <span data-i18n="Ganzzahlen erzwingen">Ganzzahlen erzwingen</span></label>
                </div>

                <div class="card-header">
                    <h2 class="card-title" data-i18n="Quick-Aktionen">Quick-Aktionen</h2>
                </div>
                <div class="button-group">
                    <input type="number" id="bf3dStraightLength" value="100" style="width: 80px;">
                    <select id="bf3dStraightDirection">
                        <option value="x">X</option>
                        <option value="y">Y</option>
                        <option value="z">Z</option>
                    </select>
                    <button type="button" id="bf3dAddStraight" class="btn-secondary" data-i18n="Gerade hinzufügen">Gerade hinzufügen</button>
                </div>
                <div class="button-group">
                    <input type="number" id="bf3dArcRadius" value="50" style="width: 80px;">
                    <select id="bf3dArcPlane">
                        <option value="xy">XY</option>
                        <option value="yz">YZ</option>
                        <option value="xz">XZ</option>
                    </select>
                    <select id="bf3dArcDirection" title="Drehrichtung" data-i18n-title="Drehrichtung">
                        <option value="ccw" data-i18n="Links (CCW)">Links (CCW)</option>
                        <option value="cw" data-i18n="Rechts (CW)">Rechts (CW)</option>
                    </select>
                    <button type="button" id="bf3dAddArc" class="btn-secondary" data-i18n="90°-Bogen hinzufügen">90°-Bogen hinzufügen</button>
                </div>
            </div>
        </div>
        <div class="bf3d-column bf3d-column--preview">
            <div class="card preview-card">
                <div class="card-header">
                    <h2 class="card-title" data-i18n="Vorschau">Vorschau</h2>
                    <div class="bf2d-preview-controls" style="margin-left: auto;">
                        <div class="bf2d-view-toggle" role="group" aria-label="Ansicht umschalten">
                            <button type="button" id="bf3dViewToggle2d" class="bf2d-view-toggle-btn is-active" aria-pressed="true" data-i18n="2D">2D</button>
                            <button type="button" id="bf3dViewToggle3d" class="bf2d-view-toggle-btn" aria-pressed="false" data-i18n="3D">3D</button>
                        </div>
                    </div>
                </div>
                <div class="bf3d-preview-container" data-view-mode="2d">
                    <div class="bf3d-preview-stage" role="img" aria-label="BF3D Vorschau">
                        <canvas id="bf3dPreview2d"></canvas>
                        <div id="bf3dPreview3d" class="bf3d-preview-3d" style="display: none;" aria-hidden="true"></div>
                    </div>
                    <div class="bf3d-dimension-toggle-group" aria-label="Bemaßungen umschalten">
                        <label class="bf3d-dimension-toggle">
                            <input type="checkbox" id="bf3dToggleDimensions" checked>
                            <span data-i18n="Maße anzeigen">Maße anzeigen</span>
                        </label>
                        <label class="bf3d-dimension-toggle">
                            <input type="checkbox" id="bf3dToggleZoneLengths" checked>
                            <span data-i18n="Zonenlängen">Zonenlängen</span>
                        </label>
                        <label class="bf3d-dimension-toggle">
                            <input type="checkbox" id="bf3dToggleOverhangs" checked>
                            <span data-i18n="Überstände">Überstände</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="card dataset-card">
                <div class="card-header">
                    <h2 class="card-title" data-i18n="BVBS-ABS Datensatz">BVBS-ABS Datensatz</h2>
                </div>
                <textarea id="bf3dDatasetOutput" readonly></textarea>
                <button type="button" id="bf3dSaveAbs" class="btn-primary" data-i18n="Als .abs speichern">Als .abs speichern</button>
            </div>
        </div>
    </div>
</div>
<div id="bfmaView" class="app-container" style="display:none;">
    <div class="bfma-layout">
        <div class="card bfma-config-card">
            <div class="card-header">
                <h2 class="card-title" data-i18n="BFMA Konfigurator">BFMA Konfigurator</h2>
            </div>
            <div class="bfma-summary-grid">
                <div class="bfma-summary-item">
                    <span class="bfma-summary-label" data-i18n="Gesamtgewicht">Gesamtgewicht</span>
                    <span class="bfma-summary-value" id="bfmaSummaryWeight">0 kg</span>
                </div>
                <div class="bfma-summary-item">
                    <span class="bfma-summary-label" data-i18n="Stäbe (Y/X/E)">Stäbe (Y/X/E)</span>
                    <span class="bfma-summary-value" id="bfmaSummaryBarCounts">0 / 0 / 0</span>
                </div>
            </div>
            <div class="bfma-form-grid">
                <div class="form-group">
                    <label for="bfmaPos" data-i18n="Pos.-Nr. (p)">Pos.-Nr. (p)</label>
                    <input type="text" id="bfmaPos" value="1">
                </div>
                <div class="form-group">
                    <label for="bfmaLength" data-i18n="Länge (l) mm">Länge (l) mm</label>
                    <input type="number" id="bfmaLength" value="5000">
                </div>
                <div class="form-group">
                    <label for="bfmaWidth" data-i18n="Breite (b) mm">Breite (b) mm</label>
                    <input type="number" id="bfmaWidth" value="2000">
                </div>
                <div class="form-group">
                    <label for="bfmaQuantity" data-i18n="Anzahl (n)">Anzahl (n)</label>
                    <input type="number" id="bfmaQuantity" value="1">
                </div>
                <div class="form-group">
                    <label for="bfmaType" data-i18n="Typ">Typ</label>
                    <input type="text" id="bfmaType" value="BWM">
                </div>
                <div class="form-group">
                    <label for="bfmaWeight" data-i18n="Gewicht (e) kg">Gewicht (e) kg</label>
                    <input type="number" id="bfmaWeight" value="0">
                </div>
                <div class="form-group">
                    <label for="bfmaSteelGrade" data-i18n="Stahlsorte (g)">Stahlsorte (g)</label>
                    <select id="bfmaSteelGrade" data-masterdata-source="steelGrades" data-masterdata-placeholder-key="Stahlsorte auswählen…" data-masterdata-default="B500A"></select>
                </div>
                <div class="form-group">
                    <label for="bfmaMeshType" data-i18n="Mattentyp (m)">Mattentyp (m)</label>
                    <select id="bfmaMeshType" data-masterdata-source="meshTypes" data-masterdata-placeholder-key="Mattentyp auswählen…" data-masterdata-default="Q257"></select>
                </div>
                <div class="form-group">
                    <label for="bfmaBendingRoll" data-i18n="Biegerolle (s) mm">Biegerolle (s) mm</label>
                    <input type="number" id="bfmaBendingRoll" value="0" disabled>
                </div>
            </div>

            <div class="bfma-storage-controls">
                <div class="form-group">
                    <label for="bfmaShapeName" data-i18n="Matten-Name">Matten-Name</label>
                    <input type="text" id="bfmaShapeName" data-i18n-placeholder="Matten-Name eingeben…" placeholder="Matten-Name eingeben…">
                </div>
                <div class="form-group">
                    <label for="bfmaSavedShapes" data-i18n="Gespeicherte Matten">Gespeicherte Matten</label>
                    <select id="bfmaSavedShapes" disabled>
                        <option value="" data-i18n="Gespeicherte Matte auswählen…">Gespeicherte Matte auswählen…</option>
                    </select>
                </div>
                <div class="bfma-storage-actions button-group">
                    <button type="button" id="bfmaSaveShapeButton" class="btn-secondary" data-i18n="Speichern">Speichern</button>
                    <button type="button" id="bfmaLoadShapeButton" class="btn-secondary" data-i18n="Laden" disabled>Laden</button>
                    <button type="button" id="bfmaDeleteShapeButton" class="btn-danger" data-i18n="Löschen" disabled>Löschen</button>
                </div>
            </div>
            <div class="bfma-tabs">
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="y-bars" data-i18n="Y-Längsstäbe">Y-Längsstäbe</button>
                    <button class="tab-button" data-tab="x-bars" data-i18n="X-Querstäbe">X-Querstäbe</button>
                    <button class="tab-button" data-tab="e-bars" data-i18n="E-Schrägstäbe">E-Schrägstäbe</button>
                </div>
                <div id="y-bars" class="tab-content active">
                    <table class="full-width-table">
                        <thead>
                            <tr>
                                <th data-i18n="d (mm)">d (mm)</th>
                                <th data-i18n="x (mm)">x (mm)</th>
                                <th data-i18n="y (mm)">y (mm)</th>
                                <th data-i18n="l (mm)">l (mm)</th>
                                <th data-i18n="e (mm;.. / mm,n)">e (mm;.. / mm,n)</th>
                                <th data-i18n="z">z</th>
                                <th data-i18n="Anzahl (berechnet)">Anzahl (berechnet)</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="bfmaYBarsBody"></tbody>
                    </table>
                    <button type="button" id="bfmaAddYBar" class="btn-secondary" data-i18n="Y-Stab hinzufügen">Y-Stab hinzufügen</button>
                </div>
                <div id="x-bars" class="tab-content">
                    <table class="full-width-table">
                        <thead>
                            <tr>
                                <th data-i18n="d (mm)">d (mm)</th>
                                <th data-i18n="x (mm)">x (mm)</th>
                                <th data-i18n="y (mm)">y (mm)</th>
                                <th data-i18n="l (mm)">l (mm)</th>
                                <th data-i18n="e (mm;.. / mm,n)">e (mm;.. / mm,n)</th>
                                <th data-i18n="z">z</th>
                                <th data-i18n="Anzahl (berechnet)">Anzahl (berechnet)</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="bfmaXBarsBody"></tbody>
                    </table>
                    <button type="button" id="bfmaAddXBar" class="btn-secondary" data-i18n="X-Stab hinzufügen">X-Stab hinzufügen</button>
                </div>
                <div id="e-bars" class="tab-content">
                    <table class="full-width-table">
                        <thead>
                            <tr>
                                <th data-i18n="d (mm)">d (mm)</th>
                                <th data-i18n="x (mm)">x (mm)</th>
                                <th data-i18n="y (mm)">y (mm)</th>
                                <th data-i18n="l (mm)">l (mm)</th>
                                <th data-i18n="w (°)">w (°)</th>
                                <th data-i18n="e (mm;.. / mm,n)">e (mm;.. / mm,n)</th>
                                <th data-i18n="z">z</th>
                                <th data-i18n="Anzahl (berechnet)">Anzahl (berechnet)</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="bfmaEBarsBody"></tbody>
                    </table>
                    <button type="button" id="bfmaAddEBar" class="btn-secondary" data-i18n="E-Stab hinzufügen">E-Stab hinzufügen</button>
                </div>
            </div>

            <div class="bfma-bending-controls">
                <div class="bfma-toggle">
                    <input type="checkbox" id="bfmaIsBent">
                    <label for="bfmaIsBent" data-i18n="Matte gebogen">Matte gebogen</label>
                </div>
                <div id="bfmaBendingEditor" style="display:none;">
                    <div class="form-group">
                        <label data-i18n="Biegerichtung">Biegerichtung</label>
                        <select id="bfmaBendingDirection">
                            <option value="Gx" data-i18n="Gx - X-Stäbe gebogen">Gx - X-Stäbe gebogen</option>
                            <option value="Gy" data-i18n="Gy - Y-Stäbe gebogen">Gy - Y-Stäbe gebogen</option>
                        </select>
                    </div>
                    <table class="full-width-table">
                        <thead>
                            <tr>
                                <th data-i18n="Typ">Typ</th>
                                <th data-i18n="Wert">Wert</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="bfmaBendingSequenceBody"></tbody>
                    </table>
                    <button type="button" id="bfmaAddBendingSegment" class="btn-secondary" data-i18n="Segment hinzufügen">Segment hinzufügen</button>
                </div>
            </div>
        </div>

        <div class="card bf2d-import-card bfma-import-card">
            <div class="card-header">
                <h2 class="card-title" data-i18n="ABS-Import/Export">ABS-Import/Export</h2>
            </div>
            <div id="bfmaDropZone" class="bf2d-drop-zone">
                <p data-i18n="ABS-Datei hierher ziehen...">ABS-Datei hierher ziehen...</p>
            </div>
            <input type="file" id="bfmaImportFileInput" accept=".abs,text/plain" style="display:none">
        </div>

        <div class="preview-column">
            <div class="card preview-card bfma-preview-card">
                <div class="card-header">
                    <h2 class="card-title" data-i18n="Vorschau">Vorschau</h2>
                    <div class="bf2d-preview-controls" style="margin-left: auto;">
                        <div class="bf2d-view-toggle" role="group" aria-label="Ansicht umschalten">
                            <button type="button" id="bfmaViewToggle2d" class="bf2d-view-toggle-btn is-active" aria-pressed="true" data-i18n="2D">2D</button>
                            <button type="button" id="bfmaViewToggle3d" class="bf2d-view-toggle-btn" aria-pressed="false" data-i18n="3D">3D</button>
                        </div>
                    <div class="bf2d-preview-actions bfma-when-3d" style="display: none;">
                         <button type="button" id="bfmaZoom3dButton" class="btn-secondary" data-i18n="Zoom to Fit">Zoom to Fit</button>
                         <div class="bfma-dimension-toggle-group">
                            <label class="bfma-dimension-toggle">
                                <input type="checkbox" id="bfmaToggleDimensions" checked>
                                <span data-i18n="Maße anzeigen">Maße anzeigen</span>
                            </label>
                            <label class="bfma-dimension-toggle">
                                <input type="checkbox" id="bfmaTogglePitch">
                                <span data-i18n="Pitch-Abstände">Pitch-Abstände</span>
                            </label>
                         </div>
                    </div>
                    </div>
                </div>
                <div class="bfma-preview-container" data-view-mode="2d">
                    <svg id="bfmaPreviewSvg"></svg>
                    <div id="bfmaPreview3d" class="bfma-preview-3d" style="display: none; width: 100%; height: 400px; position: relative;" aria-hidden="true"></div>
                </div>
            </div>
            <div class="card bfma-output-card">
                <div class="card-header">
                    <h2 class="card-title" data-i18n="BVBS-ABS Datensatz">BVBS-ABS Datensatz</h2>
                </div>
                <textarea id="bfmaDatasetOutput" readonly></textarea>
                <ul id="bfmaErrorList" class="bfma-error-list"></ul>
            </div>
        </div>
    </div>
</div>
                <div id="savedShapesView" class="app-container" style="display:none;">
                    <div class="card saved-shapes-card">
                        <div class="card-header saved-shapes-card-header">
                            <div>
                                <h2 class="card-title" data-i18n="Gespeicherte Formen">Gespeicherte Biegeformen</h2>
                                <p class="card-subtitle" data-i18n="Gespeicherte Formen Beschreibung">Überblick über alle gespeicherten Biegeformen.</p>
                            </div>
                        </div>
                        <div class="saved-shapes-controls" aria-label="Filter und Anzeigeoptionen">
                            <div class="saved-shapes-controls-row">
                                <div class="saved-shapes-search">
                                    <label class="visually-hidden" for="savedShapesSearch" data-i18n="Suchen">Suchen</label>
                                    <input type="search" id="savedShapesSearch" data-i18n-placeholder="Suchen" placeholder="Suchen" autocomplete="off">
                                </div>
                                <div class="saved-shapes-controls-actions">
                                    <button type="button" id="savedShapesResetFilters" class="stirrup-filter-reset saved-shapes-reset" data-i18n="Filter zurücksetzen">Filter zurücksetzen</button>
                                    <div class="saved-shapes-view-toggle" role="group" aria-label="Ansicht">
                                        <button type="button" id="savedShapesGridView" class="saved-shapes-view-button" data-view-mode="grid" aria-pressed="true" data-i18n-title="Rasteransicht" title="Rasteransicht">
                                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M4 4h6v6H4V4zm0 10h6v6H4v-6zm10-10h6v6h-6V4zm0 10h6v6h-6v-6z" />
                                            </svg>
                                        </button>
                                        <button type="button" id="savedShapesListView" class="saved-shapes-view-button" data-view-mode="list" aria-pressed="false" data-i18n-title="Listenansicht" title="Listenansicht">
                                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="saved-shapes-controls-row saved-shapes-controls-row--filters">
                                <div class="saved-shapes-filter">
                                    <label for="savedShapesTypeFilter" data-i18n="Typ">Typ</label>
                                    <select id="savedShapesTypeFilter">
                                        <option value="all" data-i18n="Alle">Alle</option>
                                        <option value="2d" data-i18n="Biegeformen 2D">Biegeformen 2D</option>
                                        <option value="3d" data-i18n="Biegeformen 3D">Biegeformen 3D</option>
                                        <option value="mesh" data-i18n="Matten">Matten</option>
                                    </select>
                                </div>
                                <div class="saved-shapes-filter">
                                    <label for="savedShapesDiameterFilter" data-i18n="Durchmesser">Durchmesser</label>
                                    <select id="savedShapesDiameterFilter">
                                        <option value="all" data-i18n="Alle Durchmesser">Alle Durchmesser</option>
                                    </select>
                                </div>
                                <div class="saved-shapes-filter">
                                    <label for="savedShapesSteelFilter" data-i18n="Stahlgüte">Stahlgüte</label>
                                    <select id="savedShapesSteelFilter">
                                        <option value="all" data-i18n="Alle Stahlgüten">Alle Stahlgüten</option>
                                    </select>
                                </div>
                                <div class="saved-shapes-filter">
                                    <label for="savedShapesSegmentFilter" data-i18n="Segmente">Segmente</label>
                                    <select id="savedShapesSegmentFilter">
                                        <option value="all" data-i18n="Alle Segmente">Alle Segmente</option>
                                        <option value="4">≥ 4</option>
                                        <option value="6">≥ 6</option>
                                        <option value="8">≥ 8</option>
                                    </select>
                                </div>
                                <div class="saved-shapes-filter">
                                    <label for="savedShapesSort" data-i18n="Sortierung">Sortierung</label>
                                    <select id="savedShapesSort">
                                        <option value="name-asc" data-i18n="Name A-Z">Name A-Z</option>
                                        <option value="name-desc" data-i18n="Name Z-A">Name Z-A</option>
                                        <option value="diameter-desc" data-i18n="Durchmesser (größer zuerst)">Durchmesser (größer zuerst)</option>
                                        <option value="diameter-asc" data-i18n="Durchmesser (kleiner zuerst)">Durchmesser (kleiner zuerst)</option>
                                        <option value="segments-desc" data-i18n="Segmente (mehr zuerst)">Segmente (mehr zuerst)</option>
                                        <option value="quantity-desc" data-i18n="Anzahl (mehr zuerst)">Anzahl (mehr zuerst)</option>
                                    </select>
                                </div>
                            </div>
                            <p class="saved-shapes-result" id="savedShapesResultInfo" aria-live="polite"></p>
                        </div>
                        <div class="saved-shapes-groups">
                            <section class="saved-shapes-group">
                                <div class="saved-shapes-group-header">
                                    <h3 class="saved-shapes-group-title" data-i18n="Biegeformen 2D">Biegeformen 2D</h3>
                                    <span class="saved-shapes-count" id="savedShapes2dCount">0</span>
                                </div>
                                <div class="saved-shapes-grid" id="savedShapes2dGrid"></div>
                                <p class="saved-shapes-empty" id="savedShapes2dEmpty" data-i18n="Keine gespeicherten Formen" hidden>Keine gespeicherten Biegeformen vorhanden.</p>
                            </section>
                            <section class="saved-shapes-group">
                                <div class="saved-shapes-group-header">
                                    <h3 class="saved-shapes-group-title" data-i18n="Biegeformen 3D">Biegeformen 3D</h3>
                                    <span class="saved-shapes-count" id="savedShapes3dCount">0</span>
                                </div>
                                <div class="saved-shapes-grid" id="savedShapes3dGrid"></div>
                                <p class="saved-shapes-empty" id="savedShapes3dEmpty" data-i18n="Keine gespeicherten Formen" hidden>Keine gespeicherten Biegeformen vorhanden.</p>
                            </section>
                            <section class="saved-shapes-group">
                                <div class="saved-shapes-group-header">
                                    <h3 class="saved-shapes-group-title" data-i18n="Matten">Matten</h3>
                                    <span class="saved-shapes-count" id="savedShapesMatCount">0</span>
                                </div>
                                <div class="saved-shapes-grid" id="savedShapesMatGrid"></div>
                                <p class="saved-shapes-empty" id="savedShapesMatEmpty" data-i18n="Keine gespeicherten Formen" hidden>Keine gespeicherten Biegeformen vorhanden.</p>
                            </section>
                        </div>
                    </div>
                </div>
                <div id="productionView" class="app-container" style="display:none;">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title" data-i18n="Produktionsliste">Produktionsliste</h2>
                        </div>
                        <div class="production-controls">
                            <div class="button-group">
                                <button type="button" id="printSelectedButton" class="btn-secondary" disabled>
                                    <svg viewBox="0 0 24 24"><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"></path></svg>
                                    <span data-i18n="Selektion drucken">Selektion drucken</span>
                                </button>
                            </div>
                            <input type="text" id="productionFilter" data-i18n-placeholder="Filter" placeholder="Filter">
                            <select id="productionStatusFilter">
                                <option value="all" data-i18n="Alle">Alle</option>
                                <option value="pending" data-i18n="Offen">Offen</option>
                                <option value="inProgress" data-i18n="In Arbeit">In Arbeit</option>
                                <option value="done" data-i18n="Abgeschlossen">Abgeschlossen</option>
                            </select>
                            <select id="productionSort">
                                <option value="startTime" data-i18n="Startzeit">Startzeit</option>
                                <option value="projekt" data-i18n="Projekt">Projekt</option>
                            </select>
                        </div>
                        <div class="production-table-wrapper">
                            <table id="productionTable" class="full-width-table">
                                <thead>
                                    <tr>
                                        <th style="width: 30px;"><input type="checkbox" id="selectAllCheckbox"></th>
                                        <th data-i18n="Projekt">Projekt</th>
                                        <th data-i18n="KommNr">KommNr</th>
                                        <th data-i18n="Auftrag">Auftrag</th>
                                        <th data-i18n="Pos-Nr.">Pos-Nr.</th>
                                        <th data-i18n="Status">Status</th>
                                        <th data-i18n="Startzeit">Startzeit</th>
                                        <th data-i18n="Laufzeit">Laufzeit</th>
                                        <th data-i18n="Bemerkung">Bemerkung</th>
                                        <th data-i18n="Label">Label</th>
                                        <th data-i18n="Aktionen">Aktionen</th>
                                    </tr>
                                </thead>
                                <tbody id="productionList">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="resourcesView" class="app-container" style="display:none;">
                    <div class="resources-layout">
                        <section class="card resources-list-card" aria-labelledby="resourcesListTitle">
                            <div class="card-header resources-header">
                                <div class="resources-header-text">
                                    <h2 class="card-title" id="resourcesListTitle" data-i18n="Ressourcen">Ressourcen</h2>
                                    <p class="card-subtitle" data-i18n="Ressourcen Liste Beschreibung">Übersicht aller angelegten Ressourcen und deren Einsatzgrenzen.</p>
                                </div>
                                <div class="resources-header-actions">
                                    <button type="button" id="openResourceModalButton" class="btn-primary" data-i18n="Neue Ressource anlegen">Neue Ressource anlegen</button>
                                </div>
                            </div>
                            <p id="resourceFeedback" class="info-text" aria-live="polite" role="status"></p>
                            <div class="resources-table-container">
                                <table id="resourceTable" class="resources-table full-width-table">
                                    <thead>
                                        <tr>
                                            <th scope="col" data-i18n="Ressourcename">Ressourcename</th>
                                            <th scope="col" data-i18n="Beschreibung">Beschreibung</th>
                                            <th scope="col" data-i18n="Stabdurchmesser">Stabdurchmesser</th>
                                            <th scope="col" data-i18n="Schenkellänge">Schenkellänge</th>
                                            <th scope="col" data-i18n="Unterstützte Biegeformen">Unterstützte Biegeformen</th>
                                            <th scope="col" data-i18n="Verfügbare Biegerollen">Verfügbare Biegerollen</th>
                                            <th scope="col" data-i18n="Angelegt am">Angelegt am</th>
                                            <th scope="col" data-i18n="Aktionen">Aktionen</th>
                                        </tr>
                                    </thead>
                                    <tbody id="resourceTableBody"></tbody>
                                </table>
                            </div>
                            <p id="resourceEmptyState" class="info-text" data-i18n="Keine Ressourcen vorhanden" hidden>Keine Ressourcen vorhanden.</p>
                        </section>
                        <section class="card masterdata-card" aria-labelledby="masterDataTitle">
                            <div class="card-header">
                                <h2 class="card-title" id="masterDataTitle" data-i18n="Stammdaten verwalten">Stammdaten verwalten</h2>
                                <p class="card-subtitle" data-i18n="Stammdaten Beschreibung">Verwalten Sie zentrale Werte für Materialien und Parameter.</p>
                            </div>
                            <div class="masterdata-grid">
                                <div class="masterdata-group" data-masterdata-type="steelGrades">
                                    <div class="masterdata-group-header">
                                        <h3 class="masterdata-group-title" id="masterDataSteelTitle" data-i18n="Stahlsorten">Stahlsorten</h3>
                                        <p class="masterdata-group-description" id="masterDataSteelDescription" data-i18n="Stahlsorten Beschreibung">Vordefinierte Stahlgüten für alle Konfiguratoren.</p>
                                    </div>
                                    <form class="masterdata-form" data-masterdata-form="steelGrades" novalidate aria-labelledby="masterDataSteelTitle" aria-describedby="masterDataSteelDescription masterDataSteelFeedback">
                                        <div class="masterdata-input-row">
                                            <input type="text" id="masterDataSteelInput" data-masterdata-input data-i18n-placeholder="Neue Stahlsorte hinzufügen" placeholder="Neue Stahlsorte hinzufügen" autocomplete="off">
                                            <button type="submit" class="btn-secondary" data-i18n="Hinzufügen">Hinzufügen</button>
                                        </div>
                                        <p class="info-text masterdata-feedback" id="masterDataSteelFeedback" aria-live="polite" role="status"></p>
                                    </form>
                                    <ul class="masterdata-list" id="masterDataSteelList" data-masterdata-list="steelGrades" role="list"></ul>
                                    <p class="info-text masterdata-empty" id="masterDataSteelEmpty" data-i18n="Keine Stahlsorten vorhanden" hidden>Keine Stahlsorten vorhanden.</p>
                                </div>
                                <div class="masterdata-group" data-masterdata-type="rollDiameters">
                                    <div class="masterdata-group-header">
                                        <h3 class="masterdata-group-title" id="masterDataRollTitle" data-i18n="Biegerollendurchmesser">Biegerollendurchmesser</h3>
                                        <p class="masterdata-group-description" id="masterDataRollDescription" data-i18n="Biegerollendurchmesser Beschreibung">Legt verfügbare Rollendurchmesser in Millimetern fest.</p>
                                    </div>
                                    <form class="masterdata-form" data-masterdata-form="rollDiameters" novalidate aria-labelledby="masterDataRollTitle" aria-describedby="masterDataRollDescription masterDataRollFeedback">
                                        <div class="masterdata-input-row">
                                            <input type="number" id="masterDataRollInput" data-masterdata-input step="0.1" min="0" data-i18n-placeholder="Neuen Durchmesser hinzufügen" placeholder="Neuen Durchmesser hinzufügen" autocomplete="off">
                                            <button type="submit" class="btn-secondary" data-i18n="Hinzufügen">Hinzufügen</button>
                                        </div>
                                        <p class="info-text masterdata-feedback" id="masterDataRollFeedback" aria-live="polite" role="status"></p>
                                    </form>
                                    <ul class="masterdata-list" id="masterDataRollList" data-masterdata-list="rollDiameters" role="list"></ul>
                                    <p class="info-text masterdata-empty" id="masterDataRollEmpty" data-i18n="Keine Rollendurchmesser vorhanden" hidden>Keine Rollendurchmesser vorhanden.</p>
                                </div>
                                <div class="masterdata-group" data-masterdata-type="meshTypes">
                                    <div class="masterdata-group-header">
                                        <h3 class="masterdata-group-title" id="masterDataMeshTitle" data-i18n="Mattentypen">Mattentypen</h3>
                                        <p class="masterdata-group-description" id="masterDataMeshDescription" data-i18n="Mattentypen Beschreibung">Standardisierte Mattentypen für den Mattenkonfigurator.</p>
                                    </div>
                                    <form class="masterdata-form" data-masterdata-form="meshTypes" novalidate aria-labelledby="masterDataMeshTitle" aria-describedby="masterDataMeshDescription masterDataMeshFeedback">
                                        <div class="masterdata-input-row">
                                            <input type="text" id="masterDataMeshInput" data-masterdata-input data-i18n-placeholder="Neuen Mattentyp hinzufügen" placeholder="Neuen Mattentyp hinzufügen" autocomplete="off">
                                            <button type="submit" class="btn-secondary" data-i18n="Hinzufügen">Hinzufügen</button>
                                        </div>
                                        <p class="info-text masterdata-feedback" id="masterDataMeshFeedback" aria-live="polite" role="status"></p>
                                    </form>
                                    <ul class="masterdata-list" id="masterDataMeshList" data-masterdata-list="meshTypes" role="list"></ul>
                                    <p class="info-text masterdata-empty" id="masterDataMeshEmpty" data-i18n="Keine Mattentypen vorhanden" hidden>Keine Mattentypen vorhanden.</p>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
                <div id="resourceModal" class="modal-overlay" aria-hidden="true">
                    <div class="modal-content card" role="dialog" aria-modal="true" aria-labelledby="resourceFormTitle">
                        <div class="modal-header card-header">
                            <h2 class="modal-title card-title" id="resourceFormTitle" data-i18n="Neue Ressource anlegen">Neue Ressource anlegen</h2>
                            <button type="button" class="close-modal-btn" id="resourceModalClose" data-i18n-title="Schließen" title="Schließen">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M18 6L6 18M6 6l12 12" />
                                </svg>
                            </button>
                        </div>
                        <div class="modal-body resources-modal-body">
                            <p class="modal-description" id="resourceFormDescription" data-i18n="Ressourcenverwaltung Beschreibung">Pflegen Sie Maschinen und Anlagen mit ihren Fertigungsmöglichkeiten.</p>
                            <form id="resourceForm" class="resources-form" novalidate aria-labelledby="resourceFormTitle" aria-describedby="resourceFormDescription">
                                <section class="resources-form-section" aria-labelledby="resourceBasicsTitle">
                                    <div class="resources-form-section-header">
                                        <h3 id="resourceBasicsTitle" class="resources-form-section-title" data-i18n="Ressource Stammdaten">Stammdaten</h3>
                                        <p class="resources-form-section-description" data-i18n="Ressource Stammdaten Beschreibung">Basisinformationen zur Maschine oder Anlage.</p>
                                    </div>
                                    <div class="resources-form-grid">
                                        <div class="form-group">
                                            <label for="resourceName" data-i18n="Ressourcename">Ressourcename</label>
                                            <input type="text" id="resourceName" name="resourceName" required data-i18n-placeholder="Ressourcenname eingeben" placeholder="Ressourcenname eingeben" autocomplete="off">
                                            <p class="form-hint" data-i18n="Ressource Name Hinweis">Vergeben Sie einen eindeutigen Namen, z. B. Maschinentyp oder Standort.</p>
                                        </div>
                                        <div class="form-group form-group--full">
                                            <label for="resourceDescription" data-i18n="Beschreibung">Beschreibung</label>
                                            <textarea id="resourceDescription" name="resourceDescription" rows="3" data-i18n-placeholder="Optionale Beschreibung" placeholder="Optionale Beschreibung"></textarea>
                                            <p class="form-hint" data-i18n="Ressource Beschreibung Hinweis">Ergänzende Angaben wie Besonderheiten, Ansprechpartner oder Einsatzbereich.</p>
                                        </div>
                                    </div>
                                </section>
                                <section class="resources-form-section" aria-labelledby="resourceDimensionsTitle">
                                    <div class="resources-form-section-header">
                                        <h3 id="resourceDimensionsTitle" class="resources-form-section-title" data-i18n="Ressource Maße">Fertigungsgrenzen</h3>
                                        <p class="resources-form-section-description" data-i18n="Ressource Maße Beschreibung">Definieren Sie, welche Durchmesser und Schenkellängen verarbeitet werden können.</p>
                                    </div>
                                    <div class="resources-form-subsection">
                                        <div class="resources-form-grid resources-form-grid--compact" role="group" aria-label="Stabdurchmesser">
                                            <div class="form-group">
                                                <label for="resourceMinDiameter" data-i18n="Min. Stabdurchmesser (mm)">Min. Stabdurchmesser (mm)</label>
                                                <input type="number" id="resourceMinDiameter" name="resourceMinDiameter" min="0" step="0.1" inputmode="decimal">
                                            </div>
                                            <div class="form-group">
                                                <label for="resourceMaxDiameter" data-i18n="Max. Stabdurchmesser (mm)">Max. Stabdurchmesser (mm)</label>
                                                <input type="number" id="resourceMaxDiameter" name="resourceMaxDiameter" min="0" step="0.1" inputmode="decimal">
                                            </div>
                                        </div>
                                        <p class="form-hint" data-i18n="Ressource Durchmesser Hinweis">Optional: Dezimalwerte sind mit Punkt oder Komma möglich. Freilassen, wenn keine Grenze existiert.</p>
                                    </div>
                                    <div class="resources-form-subsection">
                                        <div class="resources-form-grid resources-form-grid--compact" role="group" aria-label="Schenkellängen">
                                            <div class="form-group">
                                                <label for="resourceMinLegLength" data-i18n="Min. Schenkellänge (mm)">Min. Schenkellänge (mm)</label>
                                                <input type="number" id="resourceMinLegLength" name="resourceMinLegLength" min="0" step="1" inputmode="decimal">
                                            </div>
                                            <div class="form-group">
                                                <label for="resourceMaxLegLength" data-i18n="Max. Schenkellänge (mm)">Max. Schenkellänge (mm)</label>
                                                <input type="number" id="resourceMaxLegLength" name="resourceMaxLegLength" min="0" step="1" inputmode="decimal">
                                            </div>
                                        </div>
                                        <p class="form-hint" data-i18n="Ressource Schenkel Hinweis">Optional: Schenkellängen werden in Millimetern angegeben. Freilassen, wenn keine Grenze existiert.</p>
                                    </div>
                                </section>
                                <section class="resources-form-section" aria-labelledby="resourceCapabilitiesTitle">
                                    <div class="resources-form-section-header">
                                        <h3 id="resourceCapabilitiesTitle" class="resources-form-section-title" data-i18n="Ressource Biegeoptionen">Biegeoptionen</h3>
                                        <p class="resources-form-section-description" data-i18n="Ressource Biegeoptionen Beschreibung">Wählen Sie unterstützte Biegeformen sowie verfügbare Biegerollen.</p>
                                    </div>
                                    <div class="resources-picker-grid">
                                        <fieldset class="form-group resources-types-fieldset">
                                            <legend id="resourceTypesLegend" data-i18n="Unterstützte Biegeformen">Unterstützte Biegeformen</legend>
                                            <p class="resources-types-helper" data-i18n="Ressource Biegeformen Hinweis">Mehrfachauswahl möglich.</p>
                                            <div class="resources-types-dropdown" data-resource-types-dropdown data-default-label-key="Biegeformen auswählen">
                                                <button type="button" class="resources-types-trigger" aria-haspopup="true" aria-expanded="false" aria-controls="resourceTypesMenu">
                                                    <span class="resources-types-trigger-label" data-i18n="Biegeformen auswählen">Biegeformen auswählen</span>
                                                    <svg class="resources-types-trigger-icon" viewBox="0 0 20 20" aria-hidden="true" focusable="false">
                                                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.96l3.71-3.73a.75.75 0 0 1 1.08 1.04l-4.25 4.27a.75.75 0 0 1-1.08 0L5.21 8.27a.75.75 0 0 1 .02-1.06Z"/>
                                                    </svg>
                                                </button>
                                                <div id="resourceTypesMenu" class="resources-types-menu" role="group" aria-labelledby="resourceTypesLegend" hidden tabindex="-1">
                                                    <label class="resources-types-option">
                                                        <input type="checkbox" name="resourceTypes" value="2d">
                                                        <span data-i18n="Biegeformen 2D">Biegeformen 2D</span>
                                                    </label>
                                                    <label class="resources-types-option">
                                                        <input type="checkbox" name="resourceTypes" value="3d">
                                                        <span data-i18n="Biegeformen 3D">Biegeformen 3D</span>
                                                    </label>
                                                    <label class="resources-types-option">
                                                        <input type="checkbox" name="resourceTypes" value="mesh">
                                                        <span data-i18n="Matten">Matten</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </fieldset>
                                        <fieldset class="form-group resources-types-fieldset">
                                            <legend id="resourceRollsLegend" data-i18n="Verfügbare Biegerollen (mm)">Verfügbare Biegerollen (mm)</legend>
                                            <p class="resources-types-helper" data-i18n="Ressource Biegerollen Hinweis">Die verfügbaren Rollen stammen aus den Stammdaten.</p>
                                            <div class="resources-types-dropdown" data-roll-diameters-dropdown data-default-label-key="Biegerollen auswählen…">
                                                <button type="button" class="resources-types-trigger" aria-haspopup="true" aria-expanded="false" aria-controls="resourceRollsMenu">
                                                    <span class="resources-types-trigger-label" data-i18n="Biegerollen auswählen…">Biegerollen auswählen…</span>
                                                    <svg class="resources-types-trigger-icon" viewBox="0 0 20 20" aria-hidden="true" focusable="false">
                                                        <path d="M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.96l3.71-3.73a.75.75 0 0 1 1.08 1.04l-4.25 4.27a.75.75 0 0 1-1.08 0L5.21 8.27a.75.75 0 0 1 .02-1.06Z"/>
                                                    </svg>
                                                </button>
                                                <div id="resourceRollsMenu" class="resources-types-menu" role="group" aria-labelledby="resourceRollsLegend" hidden tabindex="-1">
                                                    <!-- Options will be populated by JavaScript -->
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                </section>
                                <div class="resources-form-footer">
                                    <div class="resources-form-footer-spacer"></div>
                                    <div class="button-group resources-form-buttons">
                                        <button type="submit" id="resourceFormSubmit" class="btn-primary" data-i18n="Ressource speichern">Ressource speichern</button>
                                        <button type="button" id="resourceFormReset" class="btn-secondary" data-i18n="Formular zurücksetzen">Formular zurücksetzen</button>
                                        <button type="button" id="resourceFormCancel" class="btn-secondary" data-i18n="Bearbeitung abbrechen">Bearbeitung abbrechen</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div id="settingsView" class="app-container" style="display:none;">
                    <header class="settings-header">
                        <h1 data-i18n="Einstellungen">Einstellungen</h1>
                        <p data-i18n="Einstellungen Beschreibung">Verwalte Sprache, Darstellung und persönliche Optionen der Anwendung.</p>
                    </header>
                    <div class="settings-grid">
                        <section class="card settings-card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="Spracheinstellungen">Spracheinstellungen</h2>
                                <p class="card-subtitle" data-i18n="Spracheinstellungen Beschreibung">Wähle deine bevorzugte Sprache für die Oberfläche.</p>
                            </div>
                            <div class="settings-section">
                                <label for="languageSelect" class="settings-label" data-i18n="Sprache wählen">Sprache wählen</label>
                                <div class="language-select">
                                    <select id="languageSelect">
                                        <option value="de" data-flag="flags/de.svg">DE</option>
                                        <option value="en" data-flag="flags/gb.svg">EN</option>
                                        <option value="pl" data-flag="flags/pl.svg">PL</option>
                                        <option value="cz" data-flag="flags/cz.svg">CZ</option>
                                    </select>
                                </div>
                            </div>
                        </section>
                        <section class="card settings-card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="Personalisierung">Personalisierung</h2>
                                <p class="card-subtitle" data-i18n="Personalisierung Beschreibung">Passe Aussehen und Verhalten der Oberfläche an deine Bedürfnisse an.</p>
                            </div>
                            <div class="settings-section">
                                <div class="settings-toggle">
                                    <div class="settings-toggle-text">
                                        <span class="settings-toggle-title" data-i18n="Dunkles Design aktivieren">Dunkles Design aktivieren</span>
                                        <span class="settings-toggle-description" data-i18n="Dunkles Design aktivieren Beschreibung">Schont die Augen bei schlechten Lichtverhältnissen durch eine dunkle Farbpalette.</span>
                                    </div>
                                    <label class="settings-switch">
                                        <input type="checkbox" id="darkModeToggle">
                                        <span class="slider" aria-hidden="true"></span>
                                    </label>
                                </div>
                                <div class="settings-toggle">
                                    <div class="settings-toggle-text">
                                        <span class="settings-toggle-title" data-i18n="Kompakte Darstellung aktivieren">Kompakte Darstellung aktivieren</span>
                                        <span class="settings-toggle-description" data-i18n="Kompakte Darstellung aktivieren Beschreibung">Reduziert Abstände und verdichtet Tabellen für mehr Inhalte auf einen Blick.</span>
                                    </div>
                                    <label class="settings-switch">
                                        <input type="checkbox" id="compactModeToggle">
                                        <span class="slider" aria-hidden="true"></span>
                                    </label>
                                </div>
                                <div class="settings-toggle">
                                    <div class="settings-toggle-text">
                                        <span class="settings-toggle-title" data-i18n="Animationen reduzieren">Animationen reduzieren</span>
                                        <span class="settings-toggle-description" data-i18n="Animationen reduzieren Beschreibung">Minimiert visuelle Bewegung für eine ruhigere Darstellung.</span>
                                    </div>
                                    <label class="settings-switch">
                                        <input type="checkbox" id="reduceMotionToggle">
                                        <span class="slider" aria-hidden="true"></span>
                                    </label>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
                <div id="serviceBusHistoryView" class="app-container" style="display:none;">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title" data-i18n="ServiceBusHistory.Heading">Service-Bus-Verlauf</h2>
                            <div class="button-group">
                                <button type="button" class="btn-secondary" id="serviceBusHistoryRefreshBtn" data-i18n="ServiceBusHistory.Actions.Refresh">Aktualisieren</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="servicebus-history-filters">
                                <div class="form-group">
                                    <label for="serviceBusHistoryTopicSelect" data-i18n="ServiceBusHistory.Filters.Topic">Topic</label>
                                    <select id="serviceBusHistoryTopicSelect"></select>
                                </div>
                                <div class="form-group">
                                    <label for="serviceBusHistorySubscriptionSelect" data-i18n="ServiceBusHistory.Filters.Subscription">Subscription</label>
                                    <select id="serviceBusHistorySubscriptionSelect" disabled></select>
                                </div>
                                <div class="form-group">
                                    <label for="serviceBusHistorySearchInput" data-i18n="ServiceBusHistory.Filters.Search">Suche</label>
                                    <input type="search" id="serviceBusHistorySearchInput" data-i18n-placeholder="ServiceBusHistory.Filters.SearchPlaceholder" placeholder="Nachrichteninhalt durchsuchen" autocomplete="off">
                                </div>
                                <div class="form-group">
                                    <label for="serviceBusHistoryPageSizeSelect" data-i18n="ServiceBusHistory.Filters.Limit">Einträge pro Seite</label>
                                    <select id="serviceBusHistoryPageSizeSelect">
                                        <option value="10">10</option>
                                        <option value="25" selected>25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                    </select>
                                </div>
                            </div>
                            <div id="serviceBusHistoryStatus" class="info-text servicebus-history-status" aria-live="polite"></div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title" data-i18n="ServiceBusHistory.TableHeading">Nachrichten</h3>
                        </div>
                        <div class="production-table-wrapper">
                            <table id="serviceBusHistoryTable" class="full-width-table servicebus-history-table">
                                <thead>
                                    <tr>
                                        <th data-i18n="ServiceBusHistory.Table.ReceivedAt">Empfangen</th>
                                        <th data-i18n="ServiceBusHistory.Table.Topic">Topic</th>
                                        <th data-i18n="ServiceBusHistory.Table.Subscription">Subscription</th>
                                        <th data-i18n="ServiceBusHistory.Table.MessageId">Message-ID</th>
                                        <th data-i18n="ServiceBusHistory.Table.Subject">Betreff</th>
                                        <th data-i18n="ServiceBusHistory.Table.ContentType">Content-Type</th>
                                        <th data-i18n="ServiceBusHistory.Table.DeliveryCount">Lieferungen</th>
                                        <th data-i18n="ServiceBusHistory.Table.RawPreview">Inhalt (Auszug)</th>
                                        <th data-i18n="ServiceBusHistory.Table.Details">Details</th>
                                    </tr>
                                </thead>
                                <tbody id="serviceBusHistoryTableBody"></tbody>
                            </table>
                        </div>
                        <div class="servicebus-history-pagination">
                            <div class="button-group servicebus-history-pagination-buttons">
                                <button type="button" class="btn-secondary" id="serviceBusHistoryPrevBtn" data-i18n="ServiceBusHistory.Pagination.Previous">Zurück</button>
                                <button type="button" class="btn-secondary" id="serviceBusHistoryNextBtn" data-i18n="ServiceBusHistory.Pagination.Next">Weiter</button>
                            </div>
                            <div class="servicebus-history-pagination-info" id="serviceBusHistoryPaginationInfo"></div>
                        </div>
                    </div>
                </div>
                <div id="databaseViewerView" class="app-container" style="display:none;">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title" data-i18n="DatabaseViewer.Title">Datenbank-Viewer</h2>
                            <div class="button-group">
                                <button type="button" class="btn-secondary" id="databaseViewerRefreshBtn" data-i18n="DatabaseViewer.Actions.Refresh">Aktualisieren</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <p class="card-subtitle" data-i18n="DatabaseViewer.Description">Überblick über gespeicherte Biegeformen und Matten im Server-Speicher.</p>
                            <div id="databaseViewerStatus" class="info-text" aria-live="polite"></div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title" data-i18n="DatabaseViewer.Table.Title">Gespeicherte Schlüssel</h3>
                        </div>
                        <div class="production-table-wrapper">
                            <table class="full-width-table" id="databaseViewerTable">
                                <thead>
                                    <tr>
                                        <th data-i18n="DatabaseViewer.Table.Key">Schlüssel</th>
                                        <th data-i18n="DatabaseViewer.Table.Count">Einträge</th>
                                        <th data-i18n="DatabaseViewer.Table.Updated">Zuletzt aktualisiert</th>
                                        <th data-i18n="DatabaseViewer.Table.Details">Details</th>
                                    </tr>
                                </thead>
                                <tbody id="databaseViewerTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="bvbsListView" class="app-container" style="display:none;">
                    <div class="bvbs-list-layout">
                        <div class="card bvbs-toolbar-card" id="bvbsUploadCard">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="BVBS-Datei-Upload">BVBS-Datei-Upload</h2>
                                <div class="button-group">
                                    <button type="button" id="bvbsListToggleUploadBtn" class="btn-secondary" aria-expanded="true" aria-controls="bvbsListUploadSection" data-i18n-expanded="Upload-Bereich ausblenden" data-i18n-collapsed="Upload-Bereich einblenden" data-expanded-fallback="Upload-Bereich ausblenden" data-collapsed-fallback="Upload-Bereich einblenden">
                                        <svg class="bvbs-upload-toggle-icon" viewBox="0 0 24 24" aria-hidden="true">
                                            <path d="M12 8l-6 6h12z" />
                                        </svg>
                                        <span class="bvbs-upload-toggle-label">Upload-Bereich ausblenden</span>
                                    </button>
                                    <input type="file" id="bvbsListFileInput" accept=".bvbs,.abs,text/plain" style="display:none">
                                    <button type="button" id="bvbsListOpenUploadBtn" class="btn-primary">
                                        <svg viewBox="0 0 24 24" aria-hidden="true">
                                            <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4c-2.89 0-5.4 1.64-6.65 4.04C2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/>
                                        </svg>
                                        <span data-i18n="Datei hochladen">Datei hochladen</span>
                                    </button>
                                </div>
                            </div>
                            <div class="bvbs-toolbar-body" id="bvbsListUploadSection">
                                <div id="bvbsListDropZone" class="bf2d-drop-zone">
                                    <div class="bf2d-drop-zone-content">
                                        <div class="bf2d-drop-zone-instructions">
                                            <svg class="bf2d-drop-zone-icon" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/>
                                            </svg>
                                            <p data-i18n="BVBS-Datei hierher ziehen oder den Button verwenden.">BVBS-Datei hierher ziehen oder<br>den Button oben verwenden.</p>
                                            <span class="bf2d-drop-zone-note" data-i18n="Dateityp: .bvbs, .abs">Dateityp: .bvbs, .abs</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bvbs-servicebus-section" id="bvbsServiceBusSection">
                                    <div class="bvbs-servicebus-header">
                                        <h3 class="card-subtitle">Azure Service Bus</h3>
                                        <p class="info-text" data-i18n="ServiceBus.Hint">Nachrichten direkt aus einem Topic/Subscription abrufen und die BVBS-Liste befüllen.</p>
                                    </div>
                                    <div class="bvbs-servicebus-grid">
                                        <div class="form-group">
                                            <label for="bvbsServiceBusNamespace" data-i18n="ServiceBus.Namespace">Namespace</label>
                                            <input type="text" id="bvbsServiceBusNamespace" placeholder="example.servicebus.windows.net" autocomplete="off">
                                        </div>
                                        <div class="form-group">
                                            <label for="bvbsServiceBusTopic" data-i18n="ServiceBus.Topic">Topic</label>
                                            <input type="text" id="bvbsServiceBusTopic" autocomplete="off">
                                        </div>
                                        <div class="form-group">
                                            <label for="bvbsServiceBusSubscription" data-i18n="ServiceBus.Subscription">Subscription</label>
                                            <input type="text" id="bvbsServiceBusSubscription" autocomplete="off">
                                        </div>
                                    <div class="form-group">
                                        <label for="bvbsServiceBusMessageCount" data-i18n="ServiceBus.MessageCount">Max. Nachrichten</label>
                                        <input type="number" id="bvbsServiceBusMessageCount" min="1" max="50" value="5">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="bvbsServiceBusConnectionString" data-i18n="ServiceBus.ConnectionString">Verbindungszeichenfolge</label>
                                    <textarea id="bvbsServiceBusConnectionString" rows="2" spellcheck="false" autocomplete="off" placeholder="Endpoint=sb://example.servicebus.windows.net/;SharedAccessKeyName=...;SharedAccessKey=..."></textarea>
                                    <div class="input-hint" data-i18n="ServiceBus.ConnectionStringHint">Wird nur für diese Sitzung verwendet und nicht gespeichert.</div>
                                </div>
                                <div class="form-group">
                                    <label for="bvbsServiceBusSasToken" data-i18n="ServiceBus.SasToken">SAS-Token</label>
                                    <textarea id="bvbsServiceBusSasToken" rows="2" spellcheck="false" autocomplete="off" placeholder="SharedAccessSignature sr=...&amp;sig=...&amp;se=...&amp;skn=..."></textarea>
                                    <div class="input-hint" data-i18n="ServiceBus.SasHint">Das SAS-Token wird nicht gespeichert.</div>
                                </div>
                                    <div class="bvbs-servicebus-options">
                                        <label class="checkbox-inline">
                                            <input type="checkbox" id="bvbsServiceBusPeekOnly" checked>
                                            <span data-i18n="ServiceBus.PeekOnly">Nur lesen (Peek)</span>
                                        </label>
                                        <label class="checkbox-inline">
                                            <input type="checkbox" id="bvbsServiceBusReplace" checked>
                                            <span data-i18n="ServiceBus.ReplaceEntries">Bestehende Einträge ersetzen</span>
                                        </label>
                                    </div>
                                    <div class="bvbs-servicebus-actions">
                                        <button type="button" class="btn-secondary" id="bvbsServiceBusFetchBtn" data-i18n="ServiceBus.Fetch">Nachrichten abrufen</button>
                                        <span id="bvbsServiceBusStatus" class="info-text" aria-live="polite"></span>
                                    </div>
                                </div>
                                <div id="bvbsListImportStatus" class="info-text" aria-live="polite"></div>
                            </div>
                        </div>
                        <div class="card bvbs-table-card">
                            <div class="card-header">
                                <h2 class="card-title" data-i18n="BVBS-Inhalt">BVBS-Inhalt</h2>
                                <div class="bvbs-filter-group bvbs-header-field">
                                    <label for="bvbsListFilterInput" data-i18n="Filter">Filter</label>
                                    <input type="search" id="bvbsListFilterInput" data-i18n-placeholder="Filter" placeholder="Filter" autocomplete="off">
                                </div>
                                <div class="bvbs-print-heading-group bvbs-header-field">
                                    <label for="bvbsPrintHeadingInput" data-i18n="Drucküberschrift">Drucküberschrift</label>
                                    <input type="text" id="bvbsPrintHeadingInput" data-i18n-placeholder="Drucküberschrift" placeholder="Drucküberschrift" autocomplete="off">
                                </div>
                                <div class="bvbs-print-actions">
                                    <button type="button" id="bvbsPrintButton" class="btn-secondary" data-i18n="BVBS-Liste drucken">BVBS-Liste drucken</button>
                                    <button type="button" id="bvbsPrintSelectedButton" class="btn-secondary" data-i18n-base-label="Auswahl drucken" data-base-label-fallback="Print selection" disabled>Auswahl drucken (0)</button>
                                </div>
                                <div class="bvbs-column-filter">
                                    <button type="button" id="bvbsColumnFilterToggle" class="btn-secondary" aria-expanded="false" aria-controls="bvbsColumnFilterMenu" data-i18n="Spaltenfilter">Spaltenfilter</button>
                                    <div id="bvbsColumnFilterMenu" class="bvbs-column-filter-menu" hidden aria-hidden="true">
                                        <div class="column-filter-menu-header">
                                            <h3 data-i18n="Spaltenfilter">Spaltenfilter</h3>
                                            <button type="button" id="bvbsColumnFilterCloseBtn" class="column-filter-close-btn" data-i18n-title="Schließen" data-i18n-aria-label="Schließen" title="Schließen" aria-label="Schließen">
                                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                                    <path d="M18 6L6 18M6 6l12 12" />
                                                </svg>
                                            </button>
                                        </div>
                                        <div class="column-filter-section">
                                            <h4 data-i18n="Spaltensichtbarkeit">Spaltensichtbarkeit</h4>
                                            <div id="bvbsColumnVisibilityList" class="column-visibility-list"></div>
                                            <div class="column-filter-actions column-visibility-actions">
                                                <button type="button" id="bvbsColumnVisibilityResetBtn" class="column-filter-reset-btn" data-i18n="Spalten zurücksetzen">Spalten zurücksetzen</button>
                                            </div>
                                        </div>
                                        <div class="column-filter-section">
                                            <h4 data-i18n="Spaltenfilter">Spaltenfilter</h4>
                                            <div id="bvbsColumnFilterList" class="column-filter-list"></div>
                                            <div class="column-filter-actions">
                                                <button type="button" id="bvbsColumnFilterResetBtn" class="column-filter-reset-btn" data-i18n="Filter zurücksetzen">Filter zurücksetzen</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="production-table-wrapper">
                                <table id="bvbsListTable" class="full-width-table">
                                    <thead>
                                        <tr>
                                            <th data-column-key="selection" class="bvbs-selection-header">
                                                <input type="checkbox" id="bvbsSelectAllCheckbox" class="bvbs-selection-checkbox" aria-label="Alle sichtbaren Zeilen auswählen" title="Alle sichtbaren Zeilen auswählen">
                                            </th>
                                            <th data-column-key="actions" data-i18n="Aktionen">Aktionen</th>
                                            <th data-column-key="displayType" data-sort-key="displayType" data-i18n="Typ">Typ</th>
                                            <th data-column-key="project" data-sort-key="project" data-i18n="Projekt">Projekt</th>
                                            <th data-column-key="plan" data-sort-key="plan" data-i18n="Plan">Plan</th>
                                            <th data-column-key="position" data-sort-key="position" data-i18n="Pos.-Nr.">Pos.-Nr.</th>
                                            <th data-column-key="itemId" data-sort-key="itemId" data-i18n="itemID">itemID</th>
                                            <th data-column-key="quantity" data-sort-key="quantity" data-i18n="Anzahl">Anzahl</th>
                                            <th data-column-key="steelGrade" data-sort-key="steelGrade" data-i18n="Güte">Güte</th>
                                            <th data-column-key="weight" data-sort-key="weight" data-i18n="Gewicht">Gewicht</th>
                                            <th data-column-key="totalLength" data-sort-key="totalLength" data-i18n="Gesamtlänge">Gesamtlänge</th>
                                            <th data-column-key="diameter" data-sort-key="diameter" data-i18n="Durchmesser">Durchmesser</th>
                                            <th data-column-key="rollDiameter" data-sort-key="rollDiameter" data-i18n="Roll⌀">Roll⌀</th>
                                            <th data-column-key="bendCount" data-sort-key="bendCount" data-i18n="Biegungen">Biegungen</th>
                                            <th data-column-key="maxSegmentLength" data-sort-key="maxSegmentLength" data-i18n="MaxSchenkel">MaxSchenkel</th>
                                            <th data-column-key="totalWeight" data-sort-key="totalWeight" data-i18n="∑ kg">∑ kg</th>
                                            <th data-column-key="totalLengthMeters" data-sort-key="totalLengthMeters" data-i18n="∑ m">∑ m</th>
                                            <th data-column-key="rawLine" data-sort-key="rawLine" data-i18n="Zeile">Zeile</th>
                                            <th data-column-key="note" data-sort-key="note" data-i18n="Notiz">Notiz</th>
                                            <th data-column-key="preview" data-i18n="2D-Vorschau">2D-Vorschau</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bvbsListTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="app-footer">
                <div class="app-footer-inner">
                    <p data-i18n="Modern BVBS Korb Generator © 2025">Modern BVBS Korb Generator &copy; 2025</p>
                </div>
            </footer>
        </div>
        <div id="bvbsPreviewModal" class="modal-overlay" aria-hidden="true">
            <div class="modal-content card" role="dialog" aria-modal="true" aria-labelledby="bvbsPreviewModalTitle">
                <div class="modal-header card-header">
                    <h2 id="bvbsPreviewModalTitle" class="modal-title card-title" data-i18n="2D-Vorschau">2D-Vorschau</h2>
                    <button type="button" class="close-modal-btn" id="bvbsPreviewModalClose" data-i18n-title="Schließen" title="Schließen">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M18 6L6 18M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <div class="modal-body bvbs-preview-modal-body">
                    <div class="bvbs-preview-modal-canvas">
                        <svg id="bvbsPreviewModalSvg" role="img" aria-labelledby="bvbsPreviewModalTitle"></svg>
                    </div>
                </div>
            </div>
        </div>
        <div id="stirrupFormModal" class="modal-overlay" aria-hidden="true">
            <div class="modal-content card" role="dialog" aria-modal="true" aria-labelledby="stirrupFormModalTitle">
                <div class="modal-header card-header">
                    <h2 id="stirrupFormModalTitle" class="modal-title card-title" data-title-base="Gespeicherte Biegeform wählen" data-i18n="Gespeicherte Biegeform wählen">Gespeicherte Biegeform wählen</h2>
                    <button type="button" class="close-modal-btn" onclick="closeStirrupFormModal()" data-i18n-title="Schließen" title="Schließen">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M18 6L6 18M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <div class="modal-body stirrup-modal-body">
                    <div class="stirrup-modal-layout">
                        <section class="stirrup-modal-left" aria-labelledby="stirrupFormModalTitle">
                            <div class="modal-search">
                                <input type="text" id="stirrupFormSearch" class="modal-search-input" data-i18n-placeholder="Suchen" placeholder="Suchen" aria-label="Suchen">
                            </div>
                            <div class="stirrup-filter-bar">
                                <div class="stirrup-filter">
                                    <label for="stirrupFormDiameterFilter" data-i18n="Durchmesser">Durchmesser</label>
                                    <select id="stirrupFormDiameterFilter">
                                        <option value="all" data-i18n="Alle Durchmesser">Alle Durchmesser</option>
                                    </select>
                                </div>
                                <div class="stirrup-filter">
                                    <label for="stirrupFormSteelFilter" data-i18n="Stahlgüte">Stahlgüte</label>
                                    <select id="stirrupFormSteelFilter">
                                        <option value="all" data-i18n="Alle Stahlgüten">Alle Stahlgüten</option>
                                    </select>
                                </div>
                                <div class="stirrup-filter">
                                    <label for="stirrupFormSegmentFilter" data-i18n="Segmente">Segmente</label>
                                    <select id="stirrupFormSegmentFilter">
                                        <option value="all" data-i18n="Alle Segmente">Alle Segmente</option>
                                        <option value="4" data-i18n="Mindestens 4 Segmente">Mindestens 4 Segmente</option>
                                        <option value="6" data-i18n="Mindestens 6 Segmente">Mindestens 6 Segmente</option>
                                        <option value="8" data-i18n="Mindestens 8 Segmente">Mindestens 8 Segmente</option>
                                    </select>
                                </div>
                                <button type="button" id="stirrupFormResetFilters" class="stirrup-filter-reset" data-i18n="Filter zurücksetzen">Filter zurücksetzen</button>
                            </div>
                            <div class="stirrup-list-wrapper">
                                <div class="stirrup-list-header">
                                    <span id="stirrupFormResultInfo" class="stirrup-form-result" data-i18n="Keine gespeicherten Biegeformen verfügbar">Keine gespeicherten Biegeformen verfügbar</span>
                                </div>
                                <div id="stirrupFormList" class="stirrup-form-list" role="listbox" aria-label="Gespeicherte Biegeformen"></div>
                                <p id="stirrupFormEmptyState" class="info-text" hidden data-i18n="Keine gespeicherten Biegeformen verfügbar">Keine gespeicherten Biegeformen verfügbar</p>
                            </div>
                        </section>
                        <aside class="stirrup-modal-preview" aria-live="polite">
                            <div id="stirrupFormPreview" class="stirrup-form-preview">
                                <p class="stirrup-form-preview__placeholder" data-i18n="Bitte wählen Sie eine Biegeform aus der Liste.">Bitte wählen Sie eine Biegeform aus der Liste.</p>
                            </div>
                        </aside>
                    </div>
                </div>
                <div class="modal-footer button-group" style="justify-content: flex-end;">
                    <button type="button" class="btn-secondary" onclick="closeStirrupFormModal()" data-i18n="Abbrechen">Abbrechen</button>
                    <button type="button" class="btn-primary" id="stirrupFormSelectButton" data-label-base="Übernehmen" data-i18n="Übernehmen" disabled>Übernehmen</button>
                </div>
            </div>
        </div>
        <div id="releaseModal" class="modal-overlay">
            <div class="modal-content card">
                <div class="modal-header card-header">
                    <h2 class="modal-title card-title" data-i18n="Startzeitpunkt">Startzeitpunkt</h2>
                    <button type="button" class="close-modal-btn" onclick="closeReleaseModal()">
                        <svg viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <p class="info-text" data-i18n="Bitte Startzeitpunkt angeben.">Bitte Startzeitpunkt angeben.</p>
                    <div class="form-group">
                        <label for="releaseStartzeit" data-i18n="Startzeitpunkt">Startzeitpunkt</label>
                        <input type="datetime-local" id="releaseStartzeit">
                    </div>
                    <div class="form-group">
                        <label for="releaseNote" data-i18n="Bemerkung">Bemerkung</label>
                        <input type="text" id="releaseNote">
                    </div>
                    <div id="releaseModalError" class="info-text" style="min-height:1.2em;"></div>
                    <div class="button-group" style="justify-content: flex-end; margin-top: 1rem;">
                        <button type="button" id="confirmReleaseButton" class="btn-primary" data-i18n="Freigeben">Freigeben</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="savedOrdersModal" class="modal-overlay">
            <div class="modal-content card">
                <div class="modal-header card-header">
                    <h2 class="modal-title card-title" data-i18n="Gespeicherte Aufträge">Gespeicherte Aufträge</h2>
                    <button type="button" class="close-modal-btn" onclick="closeSavedOrdersModal()">
                        <svg viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="savedOrdersFilterInput" data-i18n="Filter">Filter</label>
                        <input type="text" id="savedOrdersFilterInput" data-i18n-placeholder="Filter" placeholder="Filter">
                    </div>
                    <ul id="savedOrdersList" class="production-list"></ul>
                </div>
                <div class="modal-footer button-group" style="justify-content: flex-end;">
                    <button type="button" class="btn-secondary" onclick="closeSavedOrdersModal()" data-i18n="Schließen">Schließen</button>
                </div>
            </div>
        </div>

        <div id="templateManagerModal" class="modal-overlay">
            <div class="modal-content card">
                <div class="modal-header card-header">
                    <h2 class="modal-title card-title" data-i18n="Templates verwalten">Templates verwalten</h2>
                    <button type="button" class="close-modal-btn" onclick="closeTemplateManagerModal()">
                        <svg viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <p class="info-text" data-i18n="Hier können Sie Ihre gespeicherten Korb-Templates ansehen, umbenennen oder löschen. Doppelklicken Sie auf einen Template-Namen zum Bearbeiten.">Hier können Sie Ihre gespeicherten Korb-Templates ansehen, umbenennen oder löschen. Doppelklicken Sie auf einen Template-Namen zum Bearbeiten.</p>
                    <div class="template-list-container">
                        <table id="templateListTable" class="full-width-table">
                            <thead>
                                <tr>
                                    <th data-i18n="Name">Name</th>
                                    <th data-i18n="Zonenübersicht">Zonenübersicht</th>
                                    <th style="width: 80px;" data-i18n="Aktionen">Aktionen</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <div class="button-group" style="justify-content: space-between; margin-top: 1rem;">
                        <div class="button-group">
                            <button type="button" class="btn-secondary" onclick="uploadTemplatesFromJson()" data-i18n="Templates importieren">Templates importieren</button>
                            <button type="button" class="btn-secondary" onclick="downloadTemplatesAsJson()" data-i18n="Templates exportieren">Templates exportieren</button>
                        </div>
                        <button type="button" class="btn-secondary" id="deleteAllTemplatesButton" style="color: var(--danger-color); border-color: var(--danger-color);">
                            <svg viewBox="0 0 24 24" style="width: 1.1em; height: 1.1em; margin-right: .5em; fill: var(--danger-color);">
                                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12l1.41 1.41L13.41 14l2.12 2.12l-1.41 1.41L12 15.41l-2.12 2.12l-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"/>
                            </svg>
                            <span data-i18n="Alle Templates löschen">Alle Templates löschen</span>
                        </button>
                    </div>
                    <input type="file" id="templateFileInput" accept="application/json" style="display:none" onchange="handleTemplateFileImport(event)">
                </div>
                <div class="modal-footer button-group" style="justify-content: flex-end;">
                    <button type="button" class="btn-secondary" onclick="closeTemplateManagerModal()" data-i18n="Schließen">Schließen</button>
                </div>
            </div>
        </div>
        <div id="qrModal" class="modal-overlay" aria-hidden="true">
            <div class="modal-content card" role="dialog" aria-modal="true" aria-labelledby="qrModalTitle">
                <div class="modal-header card-header">
                    <h2 id="qrModalTitle" class="modal-title card-title" data-title-base="BVBS QR-Code" data-i18n="BVBS QR-Code">BVBS QR-Code</h2>
                    <button type="button" class="close-modal-btn" onclick="closeQrModal()">
                        <svg viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="qr-code-container">
                        <canvas id="qrCodeCanvas" aria-label="BVBS QR-Code"></canvas>
                    </div>
                    <pre id="qrCodeValue" class="qr-code-value"></pre>
                    <div id="qrCodeError" class="info-text error-message" style="display:none;"></div>
                </div>
                <div class="modal-footer button-group" style="justify-content: flex-end;">
                    <button type="button" class="btn-secondary" onclick="closeQrModal()" data-i18n="Schließen">Schließen</button>
                </div>
            </div>
        </div>
        <div id="zplModal" class="modal-overlay">
            <div class="modal-content card">
                <div class="modal-header card-header">
                    <h2 class="modal-title card-title" data-i18n="ZPL Code">ZPL Code</h2>
                    <button type="button" class="close-modal-btn" onclick="closeZplModal()">
                        <svg viewBox="0 0 24 24">
                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <pre id="zplCodeContent" style="white-space: pre-wrap; word-break: break-all; font-size: .9rem; background: var(--light-bg-color); padding: 1rem; border-radius: var(--border-radius);"></pre>
                </div>
                <div class="modal-footer button-group" style="justify-content: flex-end;">
                    <button type="button" class="btn-secondary" onclick="closeZplModal()" data-i18n="Schließen">Schließen</button>
                </div>
            </div>
        </div>
        <div id="print-container" style="display: none;"></div>
        <div id="bvbsPrintContainer" class="bvbs-print-container" aria-hidden="true"></div>
        <div id="standardShapeLibraryModal" class="modal-overlay" aria-hidden="true">
            <div class="modal-content card" role="dialog" aria-modal="true" aria-labelledby="standardShapeLibraryModalTitle">
                <div class="modal-header card-header">
                    <h2 id="standardShapeLibraryModalTitle" class="modal-title card-title" data-i18n="Standard-Biegeformen Bibliothek">Standard-Biegeformen Bibliothek</h2>
                    <button type="button" id="closeStandardShapeLibraryModalBtn" class="close-modal-btn" data-i18n-title="Schließen" title="Schließen">
                        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M18 6L6 18M6 6l12 12" /></svg>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="standardShapeLibraryList" class="saved-shapes-grid" data-view-mode="grid"></div>
                </div>
                <div class="modal-footer button-group" style="justify-content: flex-end;">
                    <button type="button" id="cancelStandardShapeLibraryBtn" class="btn-secondary" data-i18n="Abbrechen">Abbrechen</button>
                </div>
            </div>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bwip-js/4.1.1/bwip-js.min.js"></script>
    </body>
</html>
